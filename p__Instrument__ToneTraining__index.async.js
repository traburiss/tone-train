"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[602],{61477:function(Zt,ve,m){m.r(ve),m.d(ve,{default:function(){return Rt}});var Ne=m(26068),N=m.n(Ne),Be=m(48305),j=m.n(Be),Mt="Umi Max",he="GuitarChords",Oe=[{label:"\u5409\u4ED6\u548C\u5F26",value:"GuitarChords"},{label:"\u5341\u4E8C\u97F3\u9636",value:"12Tone"},{label:"\u516B\u5EA6\u97F3\u9636",value:"8Tone"}],Fe="guitar-acoustic",ye=[{label:"\u539F\u58F0\u5409\u4ED6",value:"guitar-acoustic"},{label:"\u7535\u5409\u4ED6",value:"guitar-electric"},{label:"\u94A2\u7434",value:"piano"}],M=["C","D","E","F","G","A","B"],oe=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],w=[2,3,4,5,6],Ut=w.flatMap(function(T){return M.map(function(t){return"".concat(t).concat(T)})}),Wt=w.flatMap(function(T){return oe.map(function(t){return"".concat(t).concat(T)})}),k=["C","D","E","F","G","A","B","Em","Am","Dm","Bm","F#m","C#m","Gm","C5","D5","E5","F5","G5","A5","B5","G7","C7","D7","E7","A7","B7","Cmaj7","Gmaj7","Fmaj7","Amaj7","Am7","Em7","Dm7","Bm7","F#m7","Dsus4","Asus4","Esus4","D/F#","C/G","G/B"],Ee=["C","D","G","A","Em","Am","Dm"],Le=["C","D","G","A","Em","Am","Dm"],Re=[{label:"\u65E0\u9650",value:"0"},{label:"20\u6B21",value:"20"},{label:"50\u6B21",value:"50"},{label:"200\u6B21",value:"200"},{label:"\u624B\u52A8\u8F93\u5165",value:"custom"}],Pe=!0,Ie=!1,Ze=1500,Me=!1,Ue=1500,Y=100,X=10*1e3,K=100,Q=function(t){var d=Number(t);if(isNaN(d))return"".concat(t);var s=Math.floor(d/1e3),f="";if(s<60)f="".concat(s,"\u79D2");else{var h=Math.floor(s/60),A=s%60;f="".concat(h,"\u5206"),A>0&&(f+="".concat(A,"\u79D2"))}return"".concat(d," \u6BEB\u79D2 (").concat(f,")")},We=1e3,we=1500,ke=2e3,Ve=1,He=!0,ze=[{label:"C2",value:"C2"},{label:"C3",value:"C3"},{label:"C4",value:"C4"},{label:"C5",value:"C5"},{label:"C6",value:"C6"}],V={toneType:he,instrumentName:Fe,toneList:Le,toneDuration:We,toneWait:we,ttsEnable:Pe,ttsWait:ke,ttsRate:Ve,ttsSolfege:Ie,ttsSolfegeWait:Ze,ttsNotation:Me,ttsNotationWait:Ue,random:He,loopCount:0,referenceNoteEnabled:!1,referenceNote:"C4"},B=m(30945),ie=m(76582),P=m(99063),$e=m(4827),q=m(81485),Je=m(39493),ce=m(29219),g=m(75271),e=m(52676),Ye=function(){return(0,e.jsxs)(ce.Z,{title:"\u57FA\u7840\u914D\u7F6E",className:"mb-3 sm:mb-6",children:[(0,e.jsx)(B.A.Group,{children:(0,e.jsx)(ie.Z.Group,{name:"instrumentName",label:"\u97F3\u8272\u9009\u62E9",tooltip:"\u7528\u6237\u53EF\u4EE5\u9009\u62E9\u81EA\u5DF1\u4E60\u60EF\u7684\u97F3\u8272\u6765\u542C\u97F3\u540D\u64AD\u653E",radioType:"button",fieldProps:{buttonStyle:"solid"},options:ye})}),(0,e.jsxs)(B.A.Group,{children:[(0,e.jsx)(ie.Z.Group,{name:"loopCountType",label:"\u5FAA\u73AF\u6B21\u6570",tooltip:"\u7528\u6237\u53EF\u4EE5\u9009\u62E9\u5FAA\u73AF\u6B21\u6570\uFF0C\u6216\u8005\u81EA\u5B9A\u4E49\u5FAA\u73AF\u6B21\u6570",radioType:"button",fieldProps:{buttonStyle:"solid"},options:Re}),(0,e.jsx)(P.Z,{name:["loopCountType"],children:function(d){var s=d.loopCountType;return s==="custom"&&(0,e.jsx)($e.Z,{name:"loopCountCustom",label:" ",width:"xs",placeholder:"\u6B21\u6570",min:1,max:1e3,fieldProps:{precision:0}})}})]}),(0,e.jsx)(B.A.Group,{children:(0,e.jsx)(q.Z,{name:"random",label:"\u968F\u673A\u64AD\u653E",tooltip:"\u4E0D\u8981\u6309\u7167\u97F3\u9636\u987A\u5E8F\u64AD\u653E\u97F3\u9636"})}),(0,e.jsxs)(B.A.Group,{children:[(0,e.jsx)(q.Z,{name:"referenceNoteEnabled",label:"\u64AD\u653E\u57FA\u51C6",tooltip:"\u64AD\u653E\u97F3\u9636\u65F6\uFF0C\u4F1A\u5148\u64AD\u653E\u57FA\u51C6\u97F3\uFF0C\u518D\u64AD\u653E\u97F3\u9636\uFF0C\u4EE5\u964D\u4F4E\u96BE\u5EA6"}),(0,e.jsx)(P.Z,{name:["referenceNoteEnabled"],children:function(d){var s=d.referenceNoteEnabled;return s&&(0,e.jsx)(Je.Z,{name:"referenceNote",label:" ",width:"xs",options:ze,placeholder:"\u9009\u62E9\u57FA\u51C6\u97F3"})}})]})]})},Xe=Ye,H=m(24871),Ke=function(){return(0,e.jsxs)(ce.Z,{title:"\u64AD\u653E\u914D\u7F6E",className:"mb-3 sm:mb-6",children:[(0,e.jsxs)(B.A.Group,{title:"\u65F6\u95F4\u8BBE\u7F6E",children:[(0,e.jsx)(H.Z,{name:"toneDuration",label:"\u97F3\u9636\u65F6\u957F",width:"md",min:Y,max:X,step:K,fieldProps:{tooltip:{formatter:Q}}}),(0,e.jsx)(H.Z,{name:"toneWait",label:"\u97F3\u9636\u64AD\u540E\u7B49\u5F85",width:"md",min:Y,max:X,step:K,fieldProps:{tooltip:{formatter:Q}}})]}),(0,e.jsxs)(B.A.Group,{title:"\u97F3\u540D\u64AD\u62A5\u8BBE\u7F6E",children:[(0,e.jsx)(q.Z,{name:"ttsEnable",label:"\u8BED\u97F3\u62A5\u97F3\u540D",tooltip:"\u6BCF\u6B21\u7ED3\u675F\u540E\u64AD\u62A5\u97F3\u540D"}),(0,e.jsx)(P.Z,{name:["ttsEnable"],children:function(d){var s=d.ttsEnable;return s&&(0,e.jsx)(H.Z,{name:"ttsRate",label:"\u62A5\u97F3\u9636\u8BED\u901F",tooltip:"\u500D\u6570\u8D8A\u5927\u8D8A\u6162",width:"md",min:.5,max:4,step:.1,fieldProps:{tooltip:{formatter:function(h){return"".concat(h,"x \u65F6\u957F")}}}})}}),(0,e.jsx)(P.Z,{name:["ttsEnable"],children:function(d){var s=d.ttsEnable;return s&&(0,e.jsx)(H.Z,{name:"ttsWait",label:"\u62A5\u97F3\u540D\u540E\u7B49\u5F85",width:"md",min:Y,max:X,step:K,fieldProps:{tooltip:{formatter:Q}}})}})]}),(0,e.jsx)(P.Z,{name:["ttsEnable"],children:function(d){var s=d.ttsEnable;return s&&(0,e.jsxs)(B.A.Group,{children:[(0,e.jsx)(q.Z,{name:"ttsSolfege",label:"\u989D\u5916\u62A5\u5531\u540D",tooltip:"\u62A5\u5B8C\u97F3\u540D\u540E\uFF0C\u8FFD\u52A0\u5531\u540D\uFF08\u5982\uFF1ADo\uFF09"}),(0,e.jsx)(P.Z,{name:["ttsSolfege"],children:function(h){var A=h.ttsSolfege;return A&&(0,e.jsx)(H.Z,{name:"ttsSolfegeWait",label:"\u5531\u540D\u95F4\u9694",width:"sm",min:Y,max:X,step:K,fieldProps:{tooltip:{formatter:Q}}})}})]})}}),(0,e.jsx)(P.Z,{name:["ttsEnable"],children:function(d){var s=d.ttsEnable;return s&&(0,e.jsxs)(B.A.Group,{children:[(0,e.jsx)(q.Z,{name:"ttsNotation",label:"\u989D\u5916\u62A5\u7B80\u8C31",tooltip:"\u62A5\u5B8C\u97F3\u540D\u540E\uFF0C\u8FFD\u52A0\u7B80\u8C31\u8BB0\u53F7\uFF08\u5982\uFF1A1\uFF09"}),(0,e.jsx)(P.Z,{name:["ttsNotation"],children:function(h){var A=h.ttsNotation;return A&&(0,e.jsx)(H.Z,{name:"ttsNotationWait",label:"\u7B80\u8C31\u95F4\u9694",width:"sm",min:Y,max:X,step:K,fieldProps:{tooltip:{formatter:Q}}})}})]})}})]})},Qe=Ke,qe=m(15558),me=m.n(qe),_e={C:"Do","C#":"\u5347Do",D:"Re","D#":"\u5347Re",E:"Mi",F:"Fa","F#":"\u5347Fa",G:"Sol","G#":"\u5347Sol",A:"La","A#":"\u5347La",B:"Si"},et={C:"1","C#":"\u53471",D:"2","D#":"\u53472",E:"3",F:"4","F#":"\u53474",G:"5","G#":"\u53475",A:"6","A#":"\u53476",B:"7"},xe={C:["C3","E3","G3","C4","E4"],D:["D3","A3","D4","F#4"],E:["E2","B2","E3","G#3","B3","E4"],F:["F2","C3","F3","A3","C4","F4"],G:["G2","B2","D3","G3","B3","G4"],A:["A2","E3","A3","C#4","E4"],B:["B2","F#3","B3","D#4","F#4"],Em:["E2","B2","E3","G3","B3","E4"],Am:["A2","E3","A3","C4","E4"],Dm:["D3","A3","D4","F4"],Bm:["B2","F#3","B3","D4","F#4"],"F#m":["F#2","C#3","F#3","A3","C#4","F#4"],"C#m":["C#3","G#3","C#4","E4","G#4"],Gm:["G2","D3","G3","A#3","D4","G4"],C5:["C3","G3","C4"],D5:["D3","A3","D4"],E5:["E2","B2","E3"],F5:["F2","C3","F3"],G5:["G2","D3","G3"],A5:["A2","E3","A3"],B5:["B2","F#3","B3"],G7:["G2","B2","D3","F3","G3","B3"],C7:["C3","E3","G3","A#3","C4"],D7:["D3","A3","C4","F#4"],E7:["E2","B2","D3","G#3","B3","E4"],A7:["A2","E3","G3","C#4","E4"],B7:["B2","D#3","A3","B3","F#4"],Cmaj7:["C3","E3","G3","B3","E4"],Gmaj7:["G2","D3","F#3","B3","D4"],Fmaj7:["F3","C4","E4","A4"],Amaj7:["A2","E3","G#3","C#4","E4"],Am7:["A2","E3","G3","C4","E4"],Em7:["E2","B2","D3","G3","B3","E4"],Dm7:["D3","A3","C4","F4"],Bm7:["B2","F#3","A3","D4","F#4"],"F#m7":["F#2","C#3","E3","A3","C#4","F#4"],Dsus4:["D3","A3","D4","G4"],Asus4:["A2","E3","A3","D4","E4"],Esus4:["E2","B2","E3","A3","B3","E4"],"D/F#":["F#2","A2","D3","A3","D4","F#4"],"C/G":["G2","C3","E3","G3","C4","E4"],"G/B":["B2","D3","G3","B3","G4"]},tt=function(t){return xe[t]||[]},fe={C:[-1,3,2,0,1,0],D:[-1,-1,0,2,3,2],E:[0,2,2,1,0,0],F:[1,3,3,2,1,1],G:[3,2,0,0,0,3],A:[-1,0,2,2,2,0],B:[-1,2,4,4,4,2],Em:[0,2,2,0,0,0],Am:[-1,0,2,2,1,0],Dm:[-1,-1,0,2,3,1],Bm:[-1,2,4,4,3,2],"F#m":[2,4,4,2,2,2],"C#m":[-1,4,6,6,5,4],Gm:[3,5,5,3,3,3],C5:[-1,3,5,5,-1,-1],D5:[-1,5,7,7,-1,-1],E5:[0,2,2,-1,-1,-1],F5:[1,3,3,-1,-1,-1],G5:[3,5,5,-1,-1,-1],A5:[-1,0,2,2,-1,-1],B5:[-1,2,4,4,-1,-1],G7:[3,2,0,0,0,1],C7:[-1,3,2,3,1,0],D7:[-1,-1,0,2,1,2],E7:[0,2,0,1,0,0],A7:[-1,0,2,0,2,0],B7:[-1,2,1,2,0,2],Cmaj7:[-1,3,2,0,0,0],Gmaj7:[3,2,0,0,0,2],Fmaj7:[-1,-1,3,2,1,0],Amaj7:[-1,0,2,1,2,0],Am7:[-1,0,2,0,1,0],Em7:[0,2,2,0,3,0],Dm7:[-1,-1,0,2,1,1],Bm7:[-1,2,4,2,3,2],"F#m7":[2,4,2,2,2,2],Dsus4:[-1,-1,0,2,3,3],Asus4:[-1,0,2,2,3,0],Esus4:[0,2,2,2,0,0],"D/F#":[2,0,0,2,3,2],"C/G":[3,3,2,0,1,0],"G/B":[-1,2,0,0,0,3]},Ae=function(t){if(xe[t])return{solfege:t,number:t};var d=t.match(/^([A-G]#?)/);if(!d)return{solfege:"",number:""};var s=d[1];return{solfege:_e[s]||"",number:et[s]||""}},U=m(95216),nt=m(22889),at=function(t){var d=t.name,s=t.fingering,f=t.width,h=f===void 0?60:f,A=t.height,p=A===void 0?80:A,S=6,b=5,L=10,C=20,o=h-L*2,l=p-C*2,r=o/(S-1),a=l/b;return(0,e.jsxs)("div",{className:"flex flex-col items-center",children:[(0,e.jsx)("span",{className:"text-sm font-bold mb-1",children:d}),(0,e.jsx)("svg",{width:h,height:p,viewBox:"0 0 ".concat(h," ").concat(p),children:(0,e.jsxs)("g",{transform:"translate(".concat(L,", ").concat(C,")"),children:[Array.from({length:b+1}).map(function(c,u){return(0,e.jsx)("line",{x1:0,y1:u*a,x2:o,y2:u*a,stroke:"#000",strokeWidth:u===0?2:1},"fret-".concat(u))}),Array.from({length:S}).map(function(c,u){return(0,e.jsx)("line",{x1:u*r,y1:0,x2:u*r,y2:l,stroke:"#000",strokeWidth:1},"string-".concat(u))}),s.map(function(c,u){var n=u*r;if(c===-1)return(0,e.jsx)("text",{x:n,y:-5,fontSize:10,textAnchor:"middle",fill:"#000",children:"X"},"mute-".concat(u));if(c===0)return(0,e.jsx)("text",{x:n,y:-5,fontSize:10,textAnchor:"middle",fill:"#000",children:"O"},"open-".concat(u));var v=(c-1)*a+a/2;return(0,e.jsx)("circle",{cx:n,cy:v,r:Math.min(r,a)*.35,fill:"#000"},"finger-".concat(u))})]})})]})},Ce=at,rt=["C","D","E","F","G","A","B"],ut=["Em","Am","Dm","Bm","F#m","C#m","Gm"],lt=["C5","D5","E5","F5","G5","A5","B5"],st=["G7","C7","D7","E7","A7","B7"],ot=["Cmaj7","Gmaj7","Fmaj7","Amaj7"],it=["Am7","Em7","Dm7","Bm7","F#m7"],ct=["Dsus4","Asus4","Esus4"],mt=["D/F#","C/G","G/B"],de=[{label:"\u5927\u4E09\u548C\u5F26 (Major)",value:"Major",chords:rt},{label:"\u5C0F\u4E09\u548C\u5F26 (Minor)",value:"Minor",chords:ut},{label:"\u5C5E\u4E03\u548C\u5F26 (7)",value:"Dom7",chords:st},{label:"\u5C0F\u4E03\u548C\u5F26 (m7)",value:"m7",chords:it},{label:"\u5927\u4E03\u548C\u5F26 (maj7)",value:"maj7",chords:ot},{label:"\u6302\u7559\u548C\u5F26 (sus)",value:"sus",chords:ct},{label:"\u659C\u6760\u548C\u5F26 (Slash)",value:"slash",chords:mt},{label:"\u5F3A\u529B\u548C\u5F26 (Power)",value:"power",chords:lt}],ft=["Major","Minor","Dom7","m7"],dt=function(t){var d=t.value,s=t.onChange,f=d||[],h=(0,g.useState)(ft),A=j()(h,2),p=A[0],S=A[1],b=function(l){var r=f.includes(l)?f.filter(function(a){return a!==l}):[].concat(me()(f),[l]);s==null||s(r)},L=function(l){var r=l.every(function(c){return f.includes(c)}),a=me()(f);r?a=a.filter(function(c){return!l.includes(c)}):l.forEach(function(c){a.includes(c)||a.push(c)}),s==null||s(a)},C=function(l,r){var a=r.every(function(c){return f.includes(c)});return(0,e.jsxs)("div",{className:"mb-6 rounded-md border border-gray-100 p-3 bg-gray-50",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,e.jsx)("span",{className:"font-bold text-base text-gray-700",children:l}),(0,e.jsx)(U.ZP,{size:"small",onClick:function(){return L(r)},children:a?"\u53D6\u6D88\u5168\u9009":"\u5168\u9009"})]}),(0,e.jsx)("div",{className:"flex flex-wrap gap-2 sm:gap-4 justify-start",children:r.map(function(c){var u=f.includes(c);return(0,e.jsx)("div",{className:`
                  cursor-pointer rounded-lg border-2 p-1 sm:p-2 bg-white transition-all
                  flex flex-col items-center
                  `.concat(u?"border-blue-500 shadow-md":"border-transparent hover:border-gray-200",`
                `),onClick:function(){return b(c)},children:(0,e.jsx)(Ce,{width:50,height:70,name:c,fingering:fe[c]})},c)})})]})};return(0,e.jsxs)("div",{className:"w-full",children:[(0,e.jsx)("div",{className:"mb-4 p-3 bg-white border border-gray-200 rounded-lg",children:(0,e.jsx)(nt.Z.Group,{options:de.map(function(o){return{label:o.label,value:o.value}}),value:p,onChange:function(l){var r=l,a=p.filter(function(n){return!r.includes(n)});if(a.length>0){var c=a.flatMap(function(n){var v=de.find(function(F){return F.value===n});return v?v.chords:[]}),u=f.filter(function(n){return!c.includes(n)});s==null||s(u)}S(r)},className:"flex flex-wrap gap-y-2"})}),de.filter(function(o){return p.includes(o.value)}).map(function(o){return(0,e.jsx)("div",{children:C(o.label,o.chords)},o.value)})]})},vt=dt,ht=m(1059),Ft=m(72783),Et=m(93817),ge=m(36065),ne=m(79662),xt=function(){var t=ge.Z.useFormInstance(),d=(0,g.useState)([]),s=j()(d,2),f=s[0],h=s[1],A=function(o){h(function(l){return l.includes(o)?l.filter(function(r){return r!==o}):[].concat(me()(l),[o])})},p=function(o,l,r){var a=r.map(function(c){return"".concat(c).concat(o)});t.setFieldValue(["toneListGroup",o],l?a:[])},S=function(o,l){var r=M.map(function(a){return"".concat(a).concat(o)});t.setFieldValue(["toneListGroup",o],l?r:[])},b=function(o,l){if(l==="GuitarChords"){var r=t.getFieldValue(["toneListGroup","chords"]);!r||r.length===0?t.setFieldValue(["toneListGroup","chords"],Ee):t.setFieldValue("toneListGroup",{chords:o?k:[]});return}var a=l==="8Tone"?M:oe,c={};w.forEach(function(u){c[u]=o?a.map(function(n){return"".concat(n).concat(u)}):[]}),t.setFieldValue("toneListGroup",c)},L=function(o){var l={};w.forEach(function(r){l[r]=o?M.map(function(a){return"".concat(a).concat(r)}):[]}),t.setFieldValue("toneListGroup",l)};return(0,e.jsx)(P.Z,{name:["toneType","toneListGroup"],children:function(o){var l=o.toneType,r=o.toneListGroup;return(0,e.jsx)(ce.Z,{title:"\u97F3\u9636\u8BBE\u7F6E",className:"scale-card mb-6",extra:(0,e.jsxs)(ne.Z,{size:12,wrap:!0,children:[(0,e.jsxs)(ne.Z,{size:4,children:[(0,e.jsx)(U.ZP,{size:"small",onClick:function(){return b(!0,l)},children:"\u5168\u9009"}),l!=="8Tone"&&l!=="GuitarChords"&&(0,e.jsx)(U.ZP,{size:"small",onClick:function(){return L(!0)},children:"\u5168\u97F3"})]}),(0,e.jsx)("div",{className:"w-[1px] h-[14px] bg-[#e8e8e8]"}),(0,e.jsx)(ie.Z.Group,{name:"toneType",noStyle:!0,radioType:"button",fieldProps:{onChange:function(c){var u=c.target.value;if(u==="GuitarChords"){var n=t.getFieldValue(["toneListGroup","chords"]);(!n||n.length===0)&&t.setFieldValue(["toneListGroup","chords"],Ee)}}},options:Oe})]}),children:(0,e.jsx)("div",{className:"flex flex-col gap-2",children:l==="GuitarChords"?(0,e.jsxs)("div",{className:"octave-row p-2 sm:p-2.5 border border-[#f0f0f0] rounded-lg bg-[#fafafa] flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-3",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2 shrink-0 w-full sm:w-auto",children:[(0,e.jsx)("span",{className:"font-bold text-[14px] sm:text-[15px] text-[#1a1a1a] mr-1",children:"\u548C\u5F26"}),(0,e.jsx)(ne.Z,{size:4,children:(0,e.jsx)(U.ZP,{size:"small",type:((r==null?void 0:r.chords)||[]).length===k.length?"primary":"default",onClick:function(){var c=((r==null?void 0:r.chords)||[]).length===k.length;t.setFieldValue(["toneListGroup","chords"],c?[]:k)},className:"text-[12px]",children:"\u5168\u9009"})}),(0,e.jsxs)("span",{className:"text-[11px] sm:text-[12px] color-[#888] ml-1 min-w-[20px]",children:["(",((r==null?void 0:r.chords)||[]).length,")"]})]}),(0,e.jsx)("div",{className:"hidden sm:block w-[1px] h-6 bg-[#e8e8e8]"}),(0,e.jsx)("div",{className:"flex flex-wrap gap-4 flex-1 w-full justify-center sm:justify-start",children:(0,e.jsx)(ge.Z.Item,{name:["toneListGroup","chords"],style:{marginBottom:0,width:"100%"},children:(0,e.jsx)(vt,{})})})]}):w.map(function(a){var c=l==="8Tone"?M:oe,u=(r==null?void 0:r[a])||[],n=u.length===c.length,v=u.length===M.length&&M.every(function(F){return u.includes("".concat(F).concat(a))});return(0,e.jsxs)("div",{className:"octave-row p-2 sm:p-2.5 border border-[#f0f0f0] rounded-lg bg-[#fafafa] flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-3",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2 shrink-0 w-full sm:w-auto",children:[(0,e.jsxs)("span",{className:"font-bold text-[14px] sm:text-[15px] text-[#1a1a1a] mr-1",children:["Oct ",a]}),(0,e.jsxs)(ne.Z,{size:4,children:[(0,e.jsx)(U.ZP,{size:"small",type:n?"primary":"default",onClick:function(){return p(a,!n,c)},className:"text-[12px]",children:"\u5168\u9009"}),l!=="8Tone"&&(0,e.jsx)(U.ZP,{size:"small",type:v?"primary":"default",onClick:function(){return S(a,!v)},className:"text-[12px]",children:"\u5168\u97F3"})]}),(0,e.jsxs)("span",{className:"text-[11px] sm:text-[12px] color-[#888] ml-1 min-w-[20px]",children:["(",u.length,")"]}),(0,e.jsx)(U.ZP,{type:"text",size:"small",className:"sm:hidden ml-auto flex items-center gap-1 text-[#1890ff]",onClick:function(){return A(a)},children:f.includes(a)?(0,e.jsxs)(e.Fragment,{children:["\u6536\u8D77 ",(0,e.jsx)(ht.Z,{className:"text-[10px]"})]}):(0,e.jsxs)(e.Fragment,{children:["\u5C55\u5F00 ",(0,e.jsx)(Ft.Z,{className:"text-[10px]"})]})})]}),(0,e.jsx)("div",{className:"hidden sm:block w-[1px] h-6 bg-[#e8e8e8]"}),(0,e.jsx)("div",{className:"".concat(f.includes(a)?"flex":"hidden sm:flex"," flex-wrap gap-1.5 flex-1 w-full"),children:(0,e.jsx)(Et.Z.Group,{name:["toneListGroup",a],className:"touch-button-group",options:c.map(function(F){return{label:F,value:"".concat(F).concat(a)}})})})]},a)})})})}})},At=xt,Ct=m(90228),ae=m.n(Ct),gt=m(87999),De=m.n(gt),Z=m(39420),Dt=function(t){var d=(0,g.useState)(function(){return{status:(0,Z.tt)(t),progress:(0,Z.O$)(t)}}),s=j()(d,2),f=s[0],h=s[1];return(0,g.useEffect)(function(){h({status:(0,Z.tt)(t),progress:(0,Z.O$)(t)});var A=(0,Z.dn)(function(p,S,b){p===t&&h({status:S,progress:b})});return function(){A()}},[t]),f},pt=m(53419),Tt=m(99430),pe=m(66931),St=m(65257),jt=m(98649),re=m(55248),bt={trainPlayInfo:"trainPlayInfo___cZ8NU"},Gt=pe.Z.confirm,y=null,Nt=function(t){var d=(0,g.useState)(!0),s=j()(d,2),f=s[0],h=s[1],A=(0,g.useState)(!1),p=j()(A,2),S=p[0],b=p[1],L=(0,g.useState)("..."),C=j()(L,2),o=C[0],l=C[1],r=St.ZP.useNotification(),a=j()(r,2),c=a[1],u=g.useRef(0),n=g.useRef(0),v=function(D){var R=new SpeechSynthesisUtterance(D),I=t.ttsRate||1;R.rate=1/I,window.speechSynthesis.speak(R)},F=g.useRef(t);F.current=t;var G=function(){var x=De()(ae()().mark(function D(R,I){var $;return ae()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return y!==null&&($=[],F.current.toneType==="GuitarChords"&&($=tt(R)),$.length>0?y.triggerAttackRelease($,I/1e3):y.triggerAttackRelease(R,I/1e3)),W.abrupt("return",new Promise(function(E){setTimeout(E,I)}));case 2:case"end":return W.stop()}},D)}));return function(R,I){return x.apply(this,arguments)}}(),z=g.useMemo(function(){var x=(t.toneDuration||0)+(t.toneWait||0)+(t.ttsWait||0)+(t.referenceNoteEnabled?(t.toneDuration||0)+(t.toneWait||0):0),D=0;return t.ttsEnable&&(D+=1e3,t.ttsSolfege&&(D+=(t.ttsSolfegeWait||0)+1e3),t.ttsNotation&&(D+=(t.ttsNotationWait||0)+1e3)),Math.max(x+D,500)},[t.toneDuration,t.toneWait,t.ttsWait,t.referenceNoteEnabled,t.ttsEnable,t.ttsSolfege,t.ttsSolfegeWait,t.ttsNotation,t.ttsNotationWait]);(0,g.useEffect)(function(){if(f||!t.open){y!==null&&y.triggerRelease(re.zO());return}var x=!1,D=null,R=null,I=function(){var je=De()(ae()().mark(function W(){var E,te,ue,J,be,le,Ge,se;return ae()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!x){i.next=2;break}return i.abrupt("return");case 2:if(E=F.current,te=E.toneList.length,te!==0){i.next=6;break}return i.abrupt("return");case 6:if(ue=0,E.random?ue=Math.floor(Math.random()*te):ue=u.current,J=E.toneList[ue],l(J),E.random){i.next=20;break}if(u.current++,!(u.current>=te)){i.next=18;break}if(u.current=0,n.current++,!(Number(E.loopCount)>0&&n.current>=Number(E.loopCount))){i.next=18;break}return h(!0),i.abrupt("return");case 18:i.next=27;break;case 20:if(u.current++,!(u.current>=te)){i.next=27;break}if(u.current=0,n.current++,!(Number(E.loopCount)>0&&n.current>=Number(E.loopCount))){i.next=27;break}return h(!0),i.abrupt("return");case 27:if(!(E.referenceNoteEnabled&&E.referenceNote)){i.next=36;break}if(!x){i.next=30;break}return i.abrupt("return");case 30:return i.next=32,G(E.referenceNote,E.toneDuration);case 32:if(!x){i.next=34;break}return i.abrupt("return");case 34:return i.next=36,new Promise(function(O){R=setTimeout(O,E.toneWait)});case 36:if(!x){i.next=38;break}return i.abrupt("return");case 38:return i.next=40,G(J,E.toneDuration);case 40:if(!x){i.next=42;break}return i.abrupt("return");case 42:if(!x){i.next=44;break}return i.abrupt("return");case 44:if(!E.ttsEnable){i.next=64;break}return i.next=47,new Promise(function(O){D=setTimeout(O,E.toneWait||200)});case 47:if(!x){i.next=49;break}return i.abrupt("return");case 49:if(v(J),!E.ttsSolfege){i.next=57;break}return i.next=53,new Promise(function(O){D=setTimeout(O,E.ttsSolfegeWait||500)});case 53:if(!x){i.next=55;break}return i.abrupt("return");case 55:be=Ae(J),le=be.solfege,le&&(v(le),l(function(O){return"".concat(O," ").concat(le)}));case 57:if(!E.ttsNotation){i.next=64;break}return i.next=60,new Promise(function(O){D=setTimeout(O,E.ttsNotationWait||500)});case 60:if(!x){i.next=62;break}return i.abrupt("return");case 62:Ge=Ae(J),se=Ge.number,se&&(v(se),l(function(O){return"".concat(O," ").concat(se)}));case 64:case"end":return i.stop()}},W)}));return function(){return je.apply(this,arguments)}}();I();var $=setInterval(I,z);return function(){x=!0,clearInterval($),D&&clearTimeout(D),R&&clearTimeout(R),y!==null&&y.triggerRelease(re.zO())}},[f,t.open,z]),(0,g.useEffect)(function(){t.open&&(u.current=0,n.current=0,l("..."),b(!1),y||(y=new re.v2(re.WV).toDestination()),(0,Z.pr)(t.instrumentName).then(function(x){y=x}).catch(function(x){console.error("\u52A0\u8F7D\u97F3\u8272\u9519\u8BEF\uFF0C\u964D\u7EA7\u4F7F\u7528Synth",x)}),h(!1))},[t.open]);var _=function(){h(!f)},ee=function(){h(!0),Gt({title:"\u786E\u8BA4\u505C\u6B62",icon:(0,e.jsx)(pt.Z,{}),content:"\u786E\u8BA4\u505C\u6B62\u8BAD\u7EC3\u5417\uFF1F",okText:"\u786E\u8BA4\u5173\u95ED",cancelText:"\u6211\u70B9\u9519\u4E86",onOk:function(){t.onCancel()},onCancel:function(){h(!1)}})},Pt=Dt(t.instrumentName),Se=Pt.status,It=function(){return Se==="loading"?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{children:"\u5F53\u524D\u7684\u97F3\u662F"}),(0,e.jsx)("div",{className:"text-yellow-600 text-sm",children:"\u97F3\u8272\u52A0\u8F7D\u4E2D, \u6682\u65F6\u4F7F\u7528MIDI\u97F3..."})]}):Se==="error"?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{children:"\u5F53\u524D\u7684\u97F3\u662F"}),(0,e.jsx)("div",{className:"text-red-600 text-sm",children:"\u97F3\u8272\u52A0\u8F7D\u5931\u8D25, \u4F7F\u7528MIDI\u97F3"})]}):"\u5F53\u524D\u7684\u97F3\u662F"};return(0,e.jsxs)(e.Fragment,{children:[c,(0,e.jsx)(pe.Z,{open:t.open,destroyOnHidden:!0,width:"80%",height:"80%",maskClosable:!1,okText:f?"\u6062\u590D\u8BAD\u7EC3":"\u6682\u505C\u8BAD\u7EC3",onOk:_,cancelText:"\u505C\u6B62\u8BAD\u7EC3",onCancel:ee,loading:S,title:S?"\u52A0\u8F7D\u97F3\u8272\u4E2D":"\u8BAD\u7EC3",children:(0,e.jsx)(jt.ZP,{className:bt.trainPlayInfo,title:It(),subTitle:(0,e.jsx)("div",{className:"text-2xl sm:text-4xl flex items-center justify-center gap-2",children:o}),icon:fe[o]?(0,e.jsx)("div",{className:"flex justify-center",children:(0,e.jsx)(Ce,{name:o,fingering:fe[o],width:100,height:140})}):(0,e.jsx)(Tt.Z,{})})})]})},Bt=Nt,Ot=m(82796),yt=m(90834),Te="music-teaching-assistant-settings",Lt=function(){var t=(0,g.useState)(V),d=j()(t,2),s=d[0],f=d[1],h=(0,g.useState)(!1),A=j()(h,2),p=A[0],S=A[1],b=B.A.useForm(),L=j()(b,1),C=L[0],o=B.A.useWatch("instrumentName",C)||Fe;(0,g.useEffect)(function(){(0,Z.pr)(o).catch(console.error)},[o]);var l=function(n,v){if(console.log("flattenGroupedTones input:",{groups:n,toneType:v}),v==="GuitarChords"){var F=n.chords||[];return console.log("Returning chords:",F),F}var G=Object.entries(n||{}).filter(function(z){var _=j()(z,1),ee=_[0];return!isNaN(Number(ee))}).map(function(z){var _=j()(z,2),ee=_[1];return ee}).flat().filter(Boolean);return console.log("Returning scales:",G),G},r=function(n){var v={};return v.chords=n.filter(function(F){return k.includes(F)}),w.forEach(function(F){v[F]=n.filter(function(G){return G.endsWith(String(F))&&!k.includes(G)})}),v};(0,g.useEffect)(function(){var u=localStorage.getItem(Te);if(u)try{var n=JSON.parse(u);n.toneList&&!n.toneListGroup&&(n.toneListGroup=r(n.toneList));var v=n.loopCountType||String(n.loopCount||0),F=n.loopCountCustom||n.loopCount||10;C.setFieldsValue(N()(N()({},n),{},{loopCountType:v,loopCountCustom:v==="custom"?F:10})),n.instrumentName&&(0,Z.pr)(n.instrumentName).catch(console.error),f(N()(N()(N()({},V),n),{},{loopCount:v==="custom"?F:parseInt(v,10),toneList:l(n.toneListGroup,n.toneType||he)}))}catch(G){console.error("Failed to load settings",G)}},[C]);var a=function(n,v){localStorage.setItem(Te,JSON.stringify(v))},c=function(n){var v=l(n.toneListGroup,n.toneType),F=n.loopCountType==="custom"?n.loopCountCustom:parseInt(n.loopCountType,10),G=N()(N()(N()({},V),n),{},{toneList:v,loopCount:isNaN(F)?0:F});f(G),S(!0)};return(0,e.jsxs)(Ot._z,{ghost:!0,className:"px-1 sm:px-4",header:{title:""},children:[(0,e.jsxs)(B.A,{form:C,size:"large",initialValues:N()(N()({},V),{},{loopCountType:String(V.loopCount),loopCountCustom:10,toneListGroup:r(V.toneList)}),onValuesChange:a,onFinish:c,layout:"horizontal",submitter:{searchConfig:{resetText:"\u91CD\u7F6E",submitText:"\u5F00\u59CB\u8BAD\u7EC3"},render:function(n,v){return(0,e.jsx)(yt.S,{children:v})}},children:[(0,e.jsx)(At,{}),(0,e.jsx)(Xe,{}),(0,e.jsx)(Qe,{})]}),(0,e.jsx)(Bt,N()({open:p,onCancel:function(){return S(!1)}},s))]})},Rt=Lt}}]);
