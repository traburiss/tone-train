"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[602],{61477:function(Ue,oe,r){r.r(oe),r.d(oe,{default:function(){return Wt}});var Fe=r(26068),y=r.n(Fe),Ae=r(48305),N=r.n(Ae),U="Umi Max",ie="GuitarChords",ce=[{label:"\u5409\u4ED6\u548C\u5F26",value:"GuitarChords"},{label:"\u5341\u4E8C\u97F3\u9636",value:"12Tone"},{label:"\u516B\u5EA6\u97F3\u9636",value:"8Tone"}],me="guitar-acoustic",xe=[{label:"\u539F\u58F0\u5409\u4ED6",value:"guitar-acoustic"},{label:"\u7535\u5409\u4ED6",value:"guitar-electric"},{label:"\u94A2\u7434",value:"piano"}],w=["C","D","E","F","G","A","B"],V=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],E=[2,3,4,5,6],G=E.flatMap(function(O){return w.map(function(t){return"".concat(t).concat(O)})}),p=E.flatMap(function(O){return V.map(function(t){return"".concat(t).concat(O)})}),A=["C","D","E","F","G","A","B","Em","Am","Dm","Bm","F#m","C#m","Gm","C5","D5","E5","F5","G5","A5","B5","G7","C7","D7","E7","A7","B7","Cmaj7","Gmaj7","Fmaj7","Amaj7","Am7","Em7","Dm7","Bm7","F#m7","Dsus4","Asus4","Esus4","D/F#","C/G","G/B"],x=["C","D","G","A","Em","Am","Dm"],k=["C","D","G","A","Em","Am","Dm"],Ce=[{label:"\u65E0\u9650",value:"0"},{label:"20\u6B21",value:"20"},{label:"50\u6B21",value:"50"},{label:"200\u6B21",value:"200"},{label:"\u624B\u52A8\u8F93\u5165",value:"custom"}],je=!0,we=!1,ze=1500,He=!1,Ve=1500,ee=100,te=10*1e3,ne=100,ae=function(t){var d=Number(t);if(isNaN(d))return"".concat(t);var o=Math.floor(d/1e3),f="";if(o<60)f="".concat(o,"\u79D2");else{var h=Math.floor(o/60),D=o%60;f="".concat(h,"\u5206"),D>0&&(f+="".concat(D,"\u79D2"))}return"".concat(d," \u6BEB\u79D2 (").concat(f,")")},ke=1e3,$e=1500,Je=2e3,Ke=1,Xe=!0,Ye=[{label:"C2",value:"C2"},{label:"C3",value:"C3"},{label:"C4",value:"C4"},{label:"C5",value:"C5"},{label:"C6",value:"C6"}],X={toneType:ie,instrumentName:me,toneList:k,toneDuration:ke,toneWait:$e,ttsEnable:je,ttsWait:Je,ttsRate:Ke,ttsSolfege:we,ttsSolfegeWait:ze,ttsNotation:He,ttsNotationWait:Ve,random:Xe,loopCount:0,referenceNoteEnabled:!1,referenceNote:"C4"},L=r(30945),pe=r(76582),z=r(99063),Qe=r(4827),re=r(81485),_e=r(39493),De=r(29219),T=r(75271),e=r(52676),qe=function(){return(0,e.jsxs)(De.Z,{title:"\u57FA\u7840\u914D\u7F6E",className:"mb-3 sm:mb-6",children:[(0,e.jsx)(L.A.Group,{children:(0,e.jsx)(pe.Z.Group,{name:"instrumentName",label:"\u97F3\u8272\u9009\u62E9",tooltip:"\u7528\u6237\u53EF\u4EE5\u9009\u62E9\u81EA\u5DF1\u4E60\u60EF\u7684\u97F3\u8272\u6765\u542C\u97F3\u540D\u64AD\u653E",radioType:"button",fieldProps:{buttonStyle:"solid",size:"small"},options:xe})}),(0,e.jsxs)(L.A.Group,{children:[(0,e.jsx)(pe.Z.Group,{name:"loopCountType",label:"\u5FAA\u73AF\u6B21\u6570",tooltip:"\u7528\u6237\u53EF\u4EE5\u9009\u62E9\u5FAA\u73AF\u6B21\u6570\uFF0C\u6216\u8005\u81EA\u5B9A\u4E49\u5FAA\u73AF\u6B21\u6570",radioType:"button",fieldProps:{buttonStyle:"solid",size:"small"},options:Ce}),(0,e.jsx)(z.Z,{name:["loopCountType"],children:function(d){var o=d.loopCountType;return o==="custom"&&(0,e.jsx)(Qe.Z,{name:"loopCountCustom",label:" ",width:"xs",placeholder:"\u6B21\u6570",min:1,max:1e3,fieldProps:{precision:0}})}})]}),(0,e.jsx)(L.A.Group,{children:(0,e.jsx)(re.Z,{name:"random",label:"\u968F\u673A\u64AD\u653E",tooltip:"\u4E0D\u8981\u6309\u7167\u97F3\u9636\u987A\u5E8F\u64AD\u653E\u97F3\u9636"})}),(0,e.jsxs)(L.A.Group,{children:[(0,e.jsx)(re.Z,{name:"referenceNoteEnabled",label:"\u64AD\u653E\u57FA\u51C6",tooltip:"\u64AD\u653E\u97F3\u9636\u65F6\uFF0C\u4F1A\u5148\u64AD\u653E\u57FA\u51C6\u97F3\uFF0C\u518D\u64AD\u653E\u97F3\u9636\uFF0C\u4EE5\u964D\u4F4E\u96BE\u5EA6"}),(0,e.jsx)(z.Z,{name:["referenceNoteEnabled"],children:function(d){var o=d.referenceNoteEnabled;return o&&(0,e.jsx)(_e.Z,{name:"referenceNote",label:" ",width:"xs",options:Ye,placeholder:"\u9009\u62E9\u57FA\u51C6\u97F3"})}})]})]})},et=qe,Y=r(24871),tt=function(){return(0,e.jsxs)(De.Z,{title:"\u64AD\u653E\u914D\u7F6E",className:"mb-3 sm:mb-6",children:[(0,e.jsxs)(L.A.Group,{title:"\u65F6\u95F4\u8BBE\u7F6E",children:[(0,e.jsx)(Y.Z,{name:"toneDuration",label:"\u97F3\u9636\u65F6\u957F",width:"md",min:ee,max:te,step:ne,fieldProps:{tooltip:{formatter:ae}}}),(0,e.jsx)(Y.Z,{name:"toneWait",label:"\u97F3\u9636\u64AD\u540E\u7B49\u5F85",width:"md",min:ee,max:te,step:ne,fieldProps:{tooltip:{formatter:ae}}})]}),(0,e.jsxs)(L.A.Group,{title:"\u97F3\u540D\u64AD\u62A5\u8BBE\u7F6E",children:[(0,e.jsx)(re.Z,{name:"ttsEnable",label:"\u8BED\u97F3\u62A5\u97F3\u540D",tooltip:"\u6BCF\u6B21\u7ED3\u675F\u540E\u64AD\u62A5\u97F3\u540D"}),(0,e.jsx)(z.Z,{name:["ttsEnable"],children:function(d){var o=d.ttsEnable;return o&&(0,e.jsx)(Y.Z,{name:"ttsRate",label:"\u62A5\u97F3\u9636\u8BED\u901F",tooltip:"\u500D\u6570\u8D8A\u5927\u8D8A\u6162",width:"md",min:.5,max:4,step:.1,fieldProps:{tooltip:{formatter:function(h){return"".concat(h,"x \u65F6\u957F")}}}})}}),(0,e.jsx)(z.Z,{name:["ttsEnable"],children:function(d){var o=d.ttsEnable;return o&&(0,e.jsx)(Y.Z,{name:"ttsWait",label:"\u62A5\u97F3\u540D\u540E\u7B49\u5F85",width:"md",min:ee,max:te,step:ne,fieldProps:{tooltip:{formatter:ae}}})}})]}),(0,e.jsx)(z.Z,{name:["ttsEnable"],children:function(d){var o=d.ttsEnable;return o&&(0,e.jsxs)(L.A.Group,{children:[(0,e.jsx)(re.Z,{name:"ttsSolfege",label:"\u989D\u5916\u62A5\u5531\u540D",tooltip:"\u62A5\u5B8C\u97F3\u540D\u540E\uFF0C\u8FFD\u52A0\u5531\u540D\uFF08\u5982\uFF1ADo\uFF09"}),(0,e.jsx)(z.Z,{name:["ttsSolfege"],children:function(h){var D=h.ttsSolfege;return D&&(0,e.jsx)(Y.Z,{name:"ttsSolfegeWait",label:"\u5531\u540D\u95F4\u9694",width:"sm",min:ee,max:te,step:ne,fieldProps:{tooltip:{formatter:ae}}})}})]})}}),(0,e.jsx)(z.Z,{name:["ttsEnable"],children:function(d){var o=d.ttsEnable;return o&&(0,e.jsxs)(L.A.Group,{children:[(0,e.jsx)(re.Z,{name:"ttsNotation",label:"\u989D\u5916\u62A5\u7B80\u8C31",tooltip:"\u62A5\u5B8C\u97F3\u540D\u540E\uFF0C\u8FFD\u52A0\u7B80\u8C31\u8BB0\u53F7\uFF08\u5982\uFF1A1\uFF09"}),(0,e.jsx)(z.Z,{name:["ttsNotation"],children:function(h){var D=h.ttsNotation;return D&&(0,e.jsx)(Y.Z,{name:"ttsNotationWait",label:"\u7B80\u8C31\u95F4\u9694",width:"sm",min:ee,max:te,step:ne,fieldProps:{tooltip:{formatter:ae}}})}})]})}})]})},nt=tt,at=r(15558),Se=r.n(at),rt={C:"Do","C#":"\u5347Do",D:"Re","D#":"\u5347Re",E:"Mi",F:"Fa","F#":"\u5347Fa",G:"Sol","G#":"\u5347Sol",A:"La","A#":"\u5347La",B:"Si"},ut={C:"1","C#":"\u53471",D:"2","D#":"\u53472",E:"3",F:"4","F#":"\u53474",G:"5","G#":"\u53475",A:"6","A#":"\u53476",B:"7"},Ne={C:["C3","E3","G3","C4","E4"],D:["D3","A3","D4","F#4"],E:["E2","B2","E3","G#3","B3","E4"],F:["F2","C3","F3","A3","C4","F4"],G:["G2","B2","D3","G3","B3","G4"],A:["A2","E3","A3","C#4","E4"],B:["B2","F#3","B3","D#4","F#4"],Em:["E2","B2","E3","G3","B3","E4"],Am:["A2","E3","A3","C4","E4"],Dm:["D3","A3","D4","F4"],Bm:["B2","F#3","B3","D4","F#4"],"F#m":["F#2","C#3","F#3","A3","C#4","F#4"],"C#m":["C#3","G#3","C#4","E4","G#4"],Gm:["G2","D3","G3","A#3","D4","G4"],C5:["C3","G3","C4"],D5:["D3","A3","D4"],E5:["E2","B2","E3"],F5:["F2","C3","F3"],G5:["G2","D3","G3"],A5:["A2","E3","A3"],B5:["B2","F#3","B3"],G7:["G2","B2","D3","F3","G3","B3"],C7:["C3","E3","G3","A#3","C4"],D7:["D3","A3","C4","F#4"],E7:["E2","B2","D3","G#3","B3","E4"],A7:["A2","E3","G3","C#4","E4"],B7:["B2","D#3","A3","B3","F#4"],Cmaj7:["C3","E3","G3","B3","E4"],Gmaj7:["G2","D3","F#3","B3","D4"],Fmaj7:["F3","C4","E4","A4"],Amaj7:["A2","E3","G#3","C#4","E4"],Am7:["A2","E3","G3","C4","E4"],Em7:["E2","B2","D3","G3","B3","E4"],Dm7:["D3","A3","C4","F4"],Bm7:["B2","F#3","A3","D4","F#4"],"F#m7":["F#2","C#3","E3","A3","C#4","F#4"],Dsus4:["D3","A3","D4","G4"],Asus4:["A2","E3","A3","D4","E4"],Esus4:["E2","B2","E3","A3","B3","E4"],"D/F#":["F#2","A2","D3","A3","D4","F#4"],"C/G":["G2","C3","E3","G3","C4","E4"],"G/B":["B2","D3","G3","B3","G4"]},lt=function(t){return Ne[t]||[]},Te={C:[-1,3,2,0,1,0],D:[-1,-1,0,2,3,2],E:[0,2,2,1,0,0],F:[1,3,3,2,1,1],G:[3,2,0,0,0,3],A:[-1,0,2,2,2,0],B:[-1,2,4,4,4,2],Em:[0,2,2,0,0,0],Am:[-1,0,2,2,1,0],Dm:[-1,-1,0,2,3,1],Bm:[-1,2,4,4,3,2],"F#m":[2,4,4,2,2,2],"C#m":[-1,4,6,6,5,4],Gm:[3,5,5,3,3,3],C5:[-1,3,5,5,-1,-1],D5:[-1,5,7,7,-1,-1],E5:[0,2,2,-1,-1,-1],F5:[1,3,3,-1,-1,-1],G5:[3,5,5,-1,-1,-1],A5:[-1,0,2,2,-1,-1],B5:[-1,2,4,4,-1,-1],G7:[3,2,0,0,0,1],C7:[-1,3,2,3,1,0],D7:[-1,-1,0,2,1,2],E7:[0,2,0,1,0,0],A7:[-1,0,2,0,2,0],B7:[-1,2,1,2,0,2],Cmaj7:[-1,3,2,0,0,0],Gmaj7:[3,2,0,0,0,2],Fmaj7:[-1,-1,3,2,1,0],Amaj7:[-1,0,2,1,2,0],Am7:[-1,0,2,0,1,0],Em7:[0,2,2,0,3,0],Dm7:[-1,-1,0,2,1,1],Bm7:[-1,2,4,2,3,2],"F#m7":[2,4,2,2,2,2],Dsus4:[-1,-1,0,2,3,3],Asus4:[-1,0,2,2,3,0],Esus4:[0,2,2,2,0,0],"D/F#":[2,0,0,2,3,2],"C/G":[3,3,2,0,1,0],"G/B":[-1,2,0,0,0,3]},Ge=function(t){if(Ne[t])return{solfege:t,number:t};var d=t.match(/^([A-G]#?)/);if(!d)return{solfege:"",number:""};var o=d[1];return{solfege:rt[o]||"",number:ut[o]||""}},J=r(95216),st=r(22889),ot=function(t){var d=t.name,o=t.fingering,f=t.width,h=f===void 0?60:f,D=t.height,j=D===void 0?80:D,B=6,P=5,Z=10,S=20,i=h-Z*2,s=j-S*2,u=i/(B-1),a=s/P;return(0,e.jsxs)("div",{className:"flex flex-col items-center",children:[(0,e.jsx)("span",{className:"text-sm font-bold mb-1",children:d}),(0,e.jsx)("svg",{width:h,height:j,viewBox:"0 0 ".concat(h," ").concat(j),children:(0,e.jsxs)("g",{transform:"translate(".concat(Z,", ").concat(S,")"),children:[Array.from({length:P+1}).map(function(m,l){return(0,e.jsx)("line",{x1:0,y1:l*a,x2:i,y2:l*a,stroke:"#000",strokeWidth:l===0?2:1},"fret-".concat(l))}),Array.from({length:B}).map(function(m,l){return(0,e.jsx)("line",{x1:l*u,y1:0,x2:l*u,y2:s,stroke:"#000",strokeWidth:1},"string-".concat(l))}),o.map(function(m,l){var n=l*u;if(m===-1)return(0,e.jsx)("text",{x:n,y:-5,fontSize:10,textAnchor:"middle",fill:"#000",children:"X"},"mute-".concat(l));if(m===0)return(0,e.jsx)("text",{x:n,y:-5,fontSize:10,textAnchor:"middle",fill:"#000",children:"O"},"open-".concat(l));var v=(m-1)*a+a/2;return(0,e.jsx)("circle",{cx:n,cy:v,r:Math.min(u,a)*.35,fill:"#000"},"finger-".concat(l))})]})})]})},Oe=ot,it=["C","D","E","F","G","A","B"],ct=["Em","Am","Dm","Bm","F#m","C#m","Gm"],mt=["C5","D5","E5","F5","G5","A5","B5"],ft=["G7","C7","D7","E7","A7","B7"],dt=["Cmaj7","Gmaj7","Fmaj7","Amaj7"],vt=["Am7","Em7","Dm7","Bm7","F#m7"],ht=["Dsus4","Asus4","Esus4"],gt=["D/F#","C/G","G/B"],be=[{label:"\u5927\u4E09\u548C\u5F26 (Major)",value:"Major",chords:it},{label:"\u5C0F\u4E09\u548C\u5F26 (Minor)",value:"Minor",chords:ct},{label:"\u5C5E\u4E03\u548C\u5F26 (7)",value:"Dom7",chords:ft},{label:"\u5C0F\u4E03\u548C\u5F26 (m7)",value:"m7",chords:vt},{label:"\u5927\u4E03\u548C\u5F26 (maj7)",value:"maj7",chords:dt},{label:"\u6302\u7559\u548C\u5F26 (sus)",value:"sus",chords:ht},{label:"\u659C\u6760\u548C\u5F26 (Slash)",value:"slash",chords:gt},{label:"\u5F3A\u529B\u548C\u5F26 (Power)",value:"power",chords:mt}],Et=["Major","Minor","Dom7","m7"],Ft=function(t){var d=t.value,o=t.onChange,f=d||[],h=(0,T.useState)(Et),D=N()(h,2),j=D[0],B=D[1],P=function(s){var u=f.includes(s)?f.filter(function(a){return a!==s}):[].concat(Se()(f),[s]);o==null||o(u)},Z=function(s){var u=s.every(function(m){return f.includes(m)}),a=Se()(f);u?a=a.filter(function(m){return!s.includes(m)}):s.forEach(function(m){a.includes(m)||a.push(m)}),o==null||o(a)},S=function(s,u){var a=u.every(function(m){return f.includes(m)});return(0,e.jsxs)("div",{className:"mb-6 rounded-md border border-gray-100 p-3 bg-gray-50",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,e.jsx)("span",{className:"font-bold text-base text-gray-700",children:s}),(0,e.jsx)(J.ZP,{size:"small",onClick:function(){return Z(u)},children:a?"\u53D6\u6D88\u5168\u9009":"\u5168\u9009"})]}),(0,e.jsx)("div",{className:"flex flex-wrap gap-2 sm:gap-4 justify-start",children:u.map(function(m){var l=f.includes(m);return(0,e.jsx)("div",{className:`
                  cursor-pointer rounded-lg border-2 p-1 sm:p-2 bg-white transition-all
                  flex flex-col items-center
                  `.concat(l?"border-blue-500 shadow-md":"border-transparent hover:border-gray-200",`
                `),onClick:function(){return P(m)},children:(0,e.jsx)(Oe,{width:50,height:70,name:m,fingering:Te[m]})},m)})})]})};return(0,e.jsxs)("div",{className:"w-full",children:[(0,e.jsx)("div",{className:"mb-4 p-3 bg-white border border-gray-200 rounded-lg",children:(0,e.jsx)(st.Z.Group,{options:be.map(function(i){return{label:i.label,value:i.value}}),value:j,onChange:function(s){var u=s,a=j.filter(function(n){return!u.includes(n)});if(a.length>0){var m=a.flatMap(function(n){var v=be.find(function(g){return g.value===n});return v?v.chords:[]}),l=f.filter(function(n){return!m.includes(n)});o==null||o(l)}B(u)},className:"flex flex-wrap gap-y-2"})}),be.filter(function(i){return j.includes(i.value)}).map(function(i){return(0,e.jsx)("div",{children:S(i.label,i.chords)},i.value)})]})},At=Ft,xt=r(1059),Ct=r(72783),pt=r(93817),Be=r(36065),fe=r(79662),Dt=function(){var t=Be.Z.useFormInstance(),d=(0,T.useState)([]),o=N()(d,2),f=o[0],h=o[1],D=function(i){h(function(s){return s.includes(i)?s.filter(function(u){return u!==i}):[].concat(Se()(s),[i])})},j=function(i,s,u){var a=u.map(function(m){return"".concat(m).concat(i)});t.setFieldValue(["toneListGroup",i],s?a:[])},B=function(i,s){var u=w.map(function(a){return"".concat(a).concat(i)});t.setFieldValue(["toneListGroup",i],s?u:[])},P=function(i,s){if(s==="GuitarChords"){var u=t.getFieldValue(["toneListGroup","chords"]);!u||u.length===0?t.setFieldValue(["toneListGroup","chords"],x):t.setFieldValue("toneListGroup",{chords:i?A:[]});return}var a=s==="8Tone"?w:V,m={};E.forEach(function(l){m[l]=i?a.map(function(n){return"".concat(n).concat(l)}):[]}),t.setFieldValue("toneListGroup",m)},Z=function(i){var s={};E.forEach(function(u){s[u]=i?w.map(function(a){return"".concat(a).concat(u)}):[]}),t.setFieldValue("toneListGroup",s)};return(0,e.jsx)(z.Z,{name:["toneType","toneListGroup"],children:function(i){var s=i.toneType,u=i.toneListGroup;return(0,e.jsx)(De.Z,{title:"\u97F3\u9636\u8BBE\u7F6E",className:"scale-card mb-6",extra:(0,e.jsxs)(fe.Z,{size:12,wrap:!0,children:[(0,e.jsxs)(fe.Z,{size:4,children:[(0,e.jsx)(J.ZP,{size:"small",onClick:function(){return P(!0,s)},children:"\u5168\u9009"}),s!=="8Tone"&&s!=="GuitarChords"&&(0,e.jsx)(J.ZP,{size:"small",onClick:function(){return Z(!0)},children:"\u5168\u97F3"})]}),(0,e.jsx)("div",{className:"w-[1px] h-[14px] bg-[#e8e8e8]"}),(0,e.jsx)(pe.Z.Group,{name:"toneType",noStyle:!0,radioType:"button",fieldProps:{size:"small",onChange:function(m){var l=m.target.value;if(l==="GuitarChords"){var n=t.getFieldValue(["toneListGroup","chords"]);(!n||n.length===0)&&t.setFieldValue(["toneListGroup","chords"],x)}}},options:ce})]}),children:(0,e.jsx)("div",{className:"flex flex-col gap-2",children:s==="GuitarChords"?(0,e.jsxs)("div",{className:"octave-row p-2 sm:p-2.5 border border-[#f0f0f0] rounded-lg bg-[#fafafa] flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-3",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2 shrink-0 w-full sm:w-auto",children:[(0,e.jsx)("span",{className:"font-bold text-[14px] sm:text-[15px] text-[#1a1a1a] mr-1",children:"\u548C\u5F26"}),(0,e.jsx)(fe.Z,{size:4,children:(0,e.jsx)(J.ZP,{size:"small",type:((u==null?void 0:u.chords)||[]).length===A.length?"primary":"default",onClick:function(){var m=((u==null?void 0:u.chords)||[]).length===A.length;t.setFieldValue(["toneListGroup","chords"],m?[]:A)},className:"text-[12px]",children:"\u5168\u9009"})}),(0,e.jsxs)("span",{className:"text-[11px] sm:text-[12px] color-[#888] ml-1 min-w-[20px]",children:["(",((u==null?void 0:u.chords)||[]).length,")"]})]}),(0,e.jsx)("div",{className:"hidden sm:block w-[1px] h-6 bg-[#e8e8e8]"}),(0,e.jsx)("div",{className:"flex flex-wrap gap-4 flex-1 w-full justify-center sm:justify-start",children:(0,e.jsx)(Be.Z.Item,{name:["toneListGroup","chords"],style:{marginBottom:0,width:"100%"},children:(0,e.jsx)(At,{})})})]}):E.map(function(a){var m=s==="8Tone"?w:V,l=(u==null?void 0:u[a])||[],n=l.length===m.length,v=l.length===w.length&&w.every(function(g){return l.includes("".concat(g).concat(a))});return(0,e.jsxs)("div",{className:"octave-row p-2 sm:p-2.5 border border-[#f0f0f0] rounded-lg bg-[#fafafa] flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-3",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2 shrink-0 w-full sm:w-auto",children:[(0,e.jsxs)("span",{className:"font-bold text-[14px] sm:text-[15px] text-[#1a1a1a] mr-1",children:["Oct ",a]}),(0,e.jsxs)(fe.Z,{size:4,children:[(0,e.jsx)(J.ZP,{size:"small",type:n?"primary":"default",onClick:function(){return j(a,!n,m)},className:"text-[12px]",children:"\u5168\u9009"}),s!=="8Tone"&&(0,e.jsx)(J.ZP,{size:"small",type:v?"primary":"default",onClick:function(){return B(a,!v)},className:"text-[12px]",children:"\u5168\u97F3"})]}),(0,e.jsxs)("span",{className:"text-[11px] sm:text-[12px] color-[#888] ml-1 min-w-[20px]",children:["(",l.length,")"]}),(0,e.jsx)(J.ZP,{type:"text",size:"small",className:"sm:hidden ml-auto flex items-center gap-1 text-[#1890ff]",onClick:function(){return D(a)},children:f.includes(a)?(0,e.jsxs)(e.Fragment,{children:["\u6536\u8D77 ",(0,e.jsx)(xt.Z,{className:"text-[10px]"})]}):(0,e.jsxs)(e.Fragment,{children:["\u5C55\u5F00 ",(0,e.jsx)(Ct.Z,{className:"text-[10px]"})]})})]}),(0,e.jsx)("div",{className:"hidden sm:block w-[1px] h-6 bg-[#e8e8e8]"}),(0,e.jsx)("div",{className:"".concat(f.includes(a)?"flex":"hidden sm:flex"," flex-wrap gap-1.5 flex-1 w-full"),children:(0,e.jsx)(pt.Z.Group,{name:["toneListGroup",a],className:"touch-button-group",options:m.map(function(g){return{label:g,value:"".concat(g).concat(a)}})})})]},a)})})})}})},St=Dt,Tt=r(90228),de=r.n(Tt),bt=r(87999),ye=r.n(bt),$=r(39420),jt=function(t){var d=(0,T.useState)(function(){return{status:(0,$.tt)(t),progress:(0,$.O$)(t)}}),o=N()(d,2),f=o[0],h=o[1];return(0,T.useEffect)(function(){h({status:(0,$.tt)(t),progress:(0,$.O$)(t)});var D=(0,$.dn)(function(j,B,P){j===t&&h({status:B,progress:P})});return function(){D()}},[t]),f},Nt=r(53419),Gt=r(99430),Pe=r(66931),Ot=r(75403),Bt=r(98649),ve=r(55248),yt={trainPlayInfo:"trainPlayInfo___cZ8NU"},Pt=Pe.Z.confirm,M=null,Rt=function(t){var d=(0,T.useState)(!0),o=N()(d,2),f=o[0],h=o[1],D=(0,T.useState)(!1),j=N()(D,2),B=j[0],P=j[1],Z=(0,T.useState)("..."),S=N()(Z,2),i=S[0],s=S[1],u=Ot.ZP.useNotification(),a=N()(u,2),m=a[1],l=T.useRef(0),n=T.useRef(0),v=function(b){var W=new SpeechSynthesisUtterance(b),H=t.ttsRate||1;W.rate=1/H,window.speechSynthesis.speak(W)},g=T.useRef(t);g.current=t;var R=function(){var C=ye()(de()().mark(function b(W,H){var _;return de()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return M!==null&&(_=[],g.current.toneType==="GuitarChords"&&(_=lt(W)),_.length>0?M.triggerAttackRelease(_,H/1e3):M.triggerAttackRelease(W,H/1e3)),K.abrupt("return",new Promise(function(F){setTimeout(F,H)}));case 2:case"end":return K.stop()}},b)}));return function(W,H){return C.apply(this,arguments)}}(),Q=T.useMemo(function(){var C=(t.toneDuration||0)+(t.toneWait||0)+(t.ttsWait||0)+(t.referenceNoteEnabled?(t.toneDuration||0)+(t.toneWait||0):0),b=0;return t.ttsEnable&&(b+=1e3,t.ttsSolfege&&(b+=(t.ttsSolfegeWait||0)+1e3),t.ttsNotation&&(b+=(t.ttsNotationWait||0)+1e3)),Math.max(C+b,500)},[t.toneDuration,t.toneWait,t.ttsWait,t.referenceNoteEnabled,t.ttsEnable,t.ttsSolfege,t.ttsSolfegeWait,t.ttsNotation,t.ttsNotationWait]);(0,T.useEffect)(function(){if(f||!t.open){M!==null&&M.triggerRelease(ve.zO());return}var C=!1,b=null,W=null,H=function(){var Me=ye()(de()().mark(function K(){var F,se,he,q,Ze,ge,We,Ee;return de()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!C){c.next=2;break}return c.abrupt("return");case 2:if(F=g.current,se=F.toneList.length,se!==0){c.next=6;break}return c.abrupt("return");case 6:if(he=0,F.random?he=Math.floor(Math.random()*se):he=l.current,q=F.toneList[he],s(q),F.random){c.next=20;break}if(l.current++,!(l.current>=se)){c.next=18;break}if(l.current=0,n.current++,!(Number(F.loopCount)>0&&n.current>=Number(F.loopCount))){c.next=18;break}return h(!0),c.abrupt("return");case 18:c.next=27;break;case 20:if(l.current++,!(l.current>=se)){c.next=27;break}if(l.current=0,n.current++,!(Number(F.loopCount)>0&&n.current>=Number(F.loopCount))){c.next=27;break}return h(!0),c.abrupt("return");case 27:if(!(F.referenceNoteEnabled&&F.referenceNote)){c.next=36;break}if(!C){c.next=30;break}return c.abrupt("return");case 30:return c.next=32,R(F.referenceNote,F.toneDuration);case 32:if(!C){c.next=34;break}return c.abrupt("return");case 34:return c.next=36,new Promise(function(I){W=setTimeout(I,F.toneWait)});case 36:if(!C){c.next=38;break}return c.abrupt("return");case 38:return c.next=40,R(q,F.toneDuration);case 40:if(!C){c.next=42;break}return c.abrupt("return");case 42:if(!C){c.next=44;break}return c.abrupt("return");case 44:if(!F.ttsEnable){c.next=64;break}return c.next=47,new Promise(function(I){b=setTimeout(I,F.toneWait||200)});case 47:if(!C){c.next=49;break}return c.abrupt("return");case 49:if(v(q),!F.ttsSolfege){c.next=57;break}return c.next=53,new Promise(function(I){b=setTimeout(I,F.ttsSolfegeWait||500)});case 53:if(!C){c.next=55;break}return c.abrupt("return");case 55:Ze=Ge(q),ge=Ze.solfege,ge&&(v(ge),s(function(I){return"".concat(I," ").concat(ge)}));case 57:if(!F.ttsNotation){c.next=64;break}return c.next=60,new Promise(function(I){b=setTimeout(I,F.ttsNotationWait||500)});case 60:if(!C){c.next=62;break}return c.abrupt("return");case 62:We=Ge(q),Ee=We.number,Ee&&(v(Ee),s(function(I){return"".concat(I," ").concat(Ee)}));case 64:case"end":return c.stop()}},K)}));return function(){return Me.apply(this,arguments)}}();H();var _=setInterval(H,Q);return function(){C=!0,clearInterval(_),b&&clearTimeout(b),W&&clearTimeout(W),M!==null&&M.triggerRelease(ve.zO())}},[f,t.open,Q]),(0,T.useEffect)(function(){t.open&&(l.current=0,n.current=0,s("..."),P(!1),M||(M=new ve.v2(ve.WV).toDestination()),(0,$.pr)(t.instrumentName).then(function(C){M=C}).catch(function(C){console.error("\u52A0\u8F7D\u97F3\u8272\u9519\u8BEF\uFF0C\u964D\u7EA7\u4F7F\u7528Synth",C)}),h(!1))},[t.open]);var ue=function(){h(!f)},le=function(){h(!0),Pt({title:"\u786E\u8BA4\u505C\u6B62",icon:(0,e.jsx)(Nt.Z,{}),content:"\u786E\u8BA4\u505C\u6B62\u8BAD\u7EC3\u5417\uFF1F",okText:"\u786E\u8BA4\u5173\u95ED",cancelText:"\u6211\u70B9\u9519\u4E86",onOk:function(){t.onCancel()},onCancel:function(){h(!1)}})},Ut=jt(t.instrumentName),Ie=Ut.status,wt=function(){return Ie==="loading"?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{children:"\u5F53\u524D\u7684\u97F3\u662F"}),(0,e.jsx)("div",{className:"text-yellow-600 text-sm",children:"\u97F3\u8272\u52A0\u8F7D\u4E2D, \u6682\u65F6\u4F7F\u7528MIDI\u97F3..."})]}):Ie==="error"?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{children:"\u5F53\u524D\u7684\u97F3\u662F"}),(0,e.jsx)("div",{className:"text-red-600 text-sm",children:"\u97F3\u8272\u52A0\u8F7D\u5931\u8D25, \u4F7F\u7528MIDI\u97F3"})]}):"\u5F53\u524D\u7684\u97F3\u662F"};return(0,e.jsxs)(e.Fragment,{children:[m,(0,e.jsx)(Pe.Z,{open:t.open,destroyOnHidden:!0,width:"80%",height:"80%",maskClosable:!1,okText:f?"\u6062\u590D\u8BAD\u7EC3":"\u6682\u505C\u8BAD\u7EC3",onOk:ue,cancelText:"\u505C\u6B62\u8BAD\u7EC3",onCancel:le,loading:B,title:B?"\u52A0\u8F7D\u97F3\u8272\u4E2D":"\u8BAD\u7EC3",children:(0,e.jsx)(Bt.ZP,{className:yt.trainPlayInfo,title:wt(),subTitle:(0,e.jsx)("div",{className:"text-2xl sm:text-4xl flex items-center justify-center gap-2",children:i}),icon:Te[i]?(0,e.jsx)("div",{className:"flex justify-center",children:(0,e.jsx)(Oe,{name:i,fingering:Te[i],width:100,height:140})}):(0,e.jsx)(Gt.Z,{})})})]})},Lt=Rt,Re=r(67056),It=r(82796),Mt=r(90834),Le="tones:training",Zt=function(){var t=(0,T.useState)(X),d=N()(t,2),o=d[0],f=d[1],h=(0,T.useState)(!1),D=N()(h,2),j=D[0],B=D[1],P=L.A.useForm(),Z=N()(P,1),S=Z[0],i=L.A.useWatch("instrumentName",S)||me;(0,T.useEffect)(function(){(0,$.pr)(i).catch(console.error)},[i]);var s=function(n,v){if(console.log("flattenGroupedTones input:",{groups:n,toneType:v}),v==="GuitarChords"){var g=n.chords||[];return console.log("Returning chords:",g),g}var R=Object.entries(n||{}).filter(function(Q){var ue=N()(Q,1),le=ue[0];return!isNaN(Number(le))}).map(function(Q){var ue=N()(Q,2),le=ue[1];return le}).flat().filter(Boolean);return console.log("Returning scales:",R),R},u=function(n){var v={};return v.chords=n.filter(function(g){return A.includes(g)}),E.forEach(function(g){v[g]=n.filter(function(R){return R.endsWith(String(g))&&!A.includes(R)})}),v};(0,T.useEffect)(function(){var l=(0,Re.Tp)(Le,null);if(l)try{var n=l;n.toneList&&!n.toneListGroup&&(n.toneListGroup=u(n.toneList));var v=n.loopCountType||String(n.loopCount||0),g=n.loopCountCustom||n.loopCount||10;S.setFieldsValue(y()(y()({},n),{},{loopCountType:v,loopCountCustom:v==="custom"?g:10})),n.instrumentName&&(0,$.pr)(n.instrumentName).catch(console.error),f(y()(y()(y()({},X),n),{},{loopCount:v==="custom"?g:parseInt(v,10),toneList:s(n.toneListGroup,n.toneType||ie)}))}catch(R){console.error("Failed to load settings",R)}},[S]);var a=function(n,v){(0,Re.pd)(Le,v,"\u542C\u97F3\u8BAD\u7EC3\u914D\u7F6E")},m=function(n){var v=s(n.toneListGroup,n.toneType),g=n.loopCountType==="custom"?n.loopCountCustom:parseInt(n.loopCountType,10),R=y()(y()(y()({},X),n),{},{toneList:v,loopCount:isNaN(g)?0:g});f(R),B(!0)};return(0,e.jsxs)(It._z,{ghost:!0,className:"px-1 sm:px-4",header:{title:""},children:[(0,e.jsxs)(L.A,{form:S,size:"large",initialValues:y()(y()({},X),{},{loopCountType:String(X.loopCount),loopCountCustom:10,toneListGroup:u(X.toneList)}),onValuesChange:a,onFinish:m,layout:"horizontal",submitter:{searchConfig:{resetText:"\u91CD\u7F6E",submitText:"\u5F00\u59CB\u8BAD\u7EC3"},render:function(n,v){return(0,e.jsx)(Mt.S,{children:v})}},children:[(0,e.jsx)(St,{}),(0,e.jsx)(et,{}),(0,e.jsx)(nt,{})]}),(0,e.jsx)(Lt,y()({open:j,onCancel:function(){return B(!1)}},o))]})},Wt=Zt},67056:function(Ue,oe,r){r.d(oe,{GR:function(){return me},QM:function(){return xe},Tp:function(){return ie},pd:function(){return ce},qt:function(){return w}});var Fe=r(48305),y=r.n(Fe),Ae=r(31759),N=r.n(Ae),U="mta:cfg",ie=function(E,G){var p=localStorage.getItem("".concat(U).concat(E));if(!p&&E==="tones:training"){var A=localStorage.getItem("music-teaching-assistant-settings");if(A)return localStorage.setItem("".concat(U).concat(E),A),JSON.parse(A)}if(!p)return G;try{var x=JSON.parse(p);return x&&N()(x)==="object"&&"name"in x&&"value"in x?x.value:x}catch(k){return console.error("Failed to parse settings for ".concat(E),k),G}},ce=function(E,G,p){var A=localStorage.getItem("".concat(U).concat(E)),x=p;if(!x&&A)try{var k=JSON.parse(A);k!=null&&k.name&&(x=k.name)}catch(je){}var Ce={name:x||E,value:G,updatedAt:Date.now()};localStorage.setItem("".concat(U).concat(E),JSON.stringify(Ce))},me=function(){for(var E={},G=0;G<localStorage.length;G++){var p=localStorage.key(G);if(p!=null&&p.startsWith(U)){var A=localStorage.getItem(p);if(A)try{E[p.replace(U,"")]=JSON.parse(A)}catch(x){console.error("Failed to parse all settings for key ".concat(p),x)}}}return E},xe=function(E){Object.entries(E).forEach(function(G){var p=y()(G,2),A=p[0],x=p[1];x&&N()(x)==="object"&&"name"in x&&"value"in x?localStorage.setItem("".concat(U).concat(A),JSON.stringify(x)):ce(A,x,A)})},w=function(){for(var E=[],G=0;G<localStorage.length;G++){var p=localStorage.key(G);p!=null&&p.startsWith(U)&&E.push(p)}E.forEach(function(A){return localStorage.removeItem(A)})}}}]);
