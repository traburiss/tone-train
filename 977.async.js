"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[977],{67849:function(ct,P,n){n.d(P,{An:function(){return g},CV:function(){return ft},Dz:function(){return p},F6:function(){return tt},Gg:function(){return l},L3:function(){return m},LB:function(){return a},N7:function(){return R},OG:function(){return f},Qx:function(){return e},Ry:function(){return et},W4:function(){return d},Yi:function(){return vt},Z:function(){return at},Zf:function(){return t},aj:function(){return c},cS:function(){return U},f1:function(){return mt},n2:function(){return nt},qL:function(){return s},qx:function(){return b},sO:function(){return ut},sw:function(){return O}});var i="Umi Max",d="GuitarChords",R=[{label:"option.tone-type.guitar-chords",value:"GuitarChords"},{label:"option.tone-type.12-tone",value:"12-Tone"},{label:"option.tone-type.8-tone",value:"8-Tone"}],f="guitar-acoustic",s=[{label:"option.instrument.guitar-acoustic",value:"guitar-acoustic"},{label:"option.instrument.guitar-electric",value:"guitar-electric"},{label:"option.instrument.piano",value:"piano"}],c=["C","D","E","F","G","A","B"],g=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],p=[2,3,4,5,6],_=p.flatMap(function(G){return c.map(function(T){return"".concat(T).concat(G)})}),w=p.flatMap(function(G){return g.map(function(T){return"".concat(T).concat(G)})}),O=["C","D","E","F","G","A","B","Em","Am","Dm","Bm","F#m","C#m","Gm","C5","D5","E5","F5","G5","A5","B5","G7","C7","D7","E7","A7","B7","Cmaj7","Gmaj7","Fmaj7","Amaj7","Am7","Em7","Dm7","Bm7","F#m7","Dsus4","Asus4","Esus4","D/F#","C/G","G/B"],l=["C","D","G","A","Em","Am","Dm"],y=["C","D","G","A","Em","Am","Dm"],b=[{label:"option.loop-count.infinite",value:"0"},{label:"option.loop-count.n-times",value:"20"},{label:"option.loop-count.n-times",value:"50"},{label:"option.loop-count.n-times",value:"200"},{label:"option.loop-count.custom",value:"custom"}],C=!0,z=!1,v=1500,r=!1,o=1500,e=100,t=10*1e3,a=100,m=function(T){return function(L){var E=Number(L);if(isNaN(E))return"".concat(L);var D=T.formatMessage({id:"formatter.millisecond"});if(E<1e3)return"".concat(E).concat(D);var M=Math.floor(E/1e3),x=E%1e3,K=T.formatMessage({id:"formatter.second"});if(M<60)return x===0?"".concat(M).concat(K):"".concat(M).concat(K).concat(x).concat(D);var rt=Math.floor(M/60),ot=M%60,N=T.formatMessage({id:"formatter.minute"});return ot===0&&x===0?"".concat(rt).concat(N).concat(x).concat(D):"".concat(rt).concat(N).concat(ot).concat(K).concat(x).concat(D)}},Z=function(T){var L=Number(T);if(isNaN(L))return"".concat(T);var E=Math.floor(L/1e3),D="";if(E<60)D="".concat(E,"s");else{var M=Math.floor(E/60),x=E%60;D="".concat(M,"m"),x>0&&(D+="".concat(x,"s"))}return"".concat(L," ms (").concat(D,")")},V=1e3,u=1500,j=2e3,Q=1,$=!0,U=[{label:"C2",value:"C2"},{label:"C3",value:"C3"},{label:"C4",value:"C4"},{label:"C5",value:"C5"},{label:"C6",value:"C6"}],ut={toneType:d,instrumentName:f,toneList:y,toneDuration:V,toneWait:u,ttsEnable:C,ttsWait:j,ttsRate:Q,ttsSolfege:z,ttsSolfegeWait:v,ttsNotation:r,ttsNotationWait:o,random:$,loopCount:0,referenceNoteEnabled:!1,referenceNote:"C4"},mt="mta:cfg:",ft="mta:sta:",tt="tones:training",et="tones:identification",at="vocal:ma-exercise",nt="vocal:resonance",vt=[{name:"menu.instrument.tone-training",key:tt},{name:"menu.instrument.tone-identification",key:et},{name:"vocal.ma-exercise.title",key:at},{name:"vocal.resonance.title",key:nt}]},32613:function(ct,P,n){n.d(P,{u:function(){return s}});var i=n(48305),d=n.n(i),R=n(75271),f=n(21017),s=function(g){var p=(0,R.useState)(function(){return{status:(0,f.tt)(g),progress:(0,f.O$)(g)}}),_=d()(p,2),w=_[0],O=_[1];return(0,R.useEffect)(function(){O({status:(0,f.tt)(g),progress:(0,f.O$)(g)});var l=(0,f.dn)(function(y,b,C){y===g&&O({status:b,progress:C})});return function(){l()}},[g]),w}},17395:function(ct,P,n){n.d(P,{Z:function(){return Z}});var i=n(90228),d=n.n(i),R=n(87999),f=n.n(R),s=n(48305),c=n.n(s),g=n(32613),p=n(21017),_=n(4373),w=n(47751),O=n(82238),l=n(27681),y=n(30933),b=n(1073),C=n(44691),z=n(63492),v=n(52402),r=n(45803),o=n(70439),e=n(75271),t=n(55248),a=n(52676),m=function(u){var j=u.visible,Q=u.onClose,$=u.patternOffsets,U=u.localizationPrefix,ut=u.startNote,mt=u.endNote,ft=u.rootNoteWait,tt=ft===void 0?1500:ft,et=u.firstNoteDuration,at=et===void 0?1500:et,nt=u.intervalDuration,vt=nt===void 0?500:nt,G=u.lastNoteDuration,T=G===void 0?1500:G,L=u.postMelodyWait,E=L===void 0?1e3:L,D=u.loopCount,M=D===void 0?2:D,x=u.countdown,K=x===void 0?3e3:x,rt=u.bpm,ot=rt===void 0?60:rt,N=(0,O.useIntl)(),fe=l.Z.useToken(),Nt=fe.token,ve=(0,e.useState)(!1),yt=c()(ve,2),jt=yt[0],Lt=yt[1],de=(0,e.useState)(!1),Ft=c()(de,2),dt=Ft[0],gt=Ft[1],ge=(0,e.useState)(null),Zt=c()(ge,2),Ut=Zt[0],St=Zt[1],Se=(0,e.useState)(!1),Gt=c()(Se,2),At=Gt[0],_t=Gt[1],pe=(0,e.useState)(1),Wt=c()(pe,2),he=Wt[0],Bt=Wt[1],Te=(0,e.useState)(0),Jt=c()(Te,2),Ee=Jt[0],Ne=Jt[1],Ae=(0,e.useState)(1),wt=c()(Ae,2),_e=wt[0],zt=wt[1],Oe=(0,e.useState)(null),Vt=c()(Oe,2),Ce=Vt[0],Ot=Vt[1],De=(0,e.useState)(""),$t=c()(De,2),Ie=$t[0],Ct=$t[1],Me=(0,e.useState)(""),Kt=c()(Me,2),xe=Kt[0],Yt=Kt[1],Re=(0,e.useState)([]),Qt=c()(Re,2),Xt=Qt[0],Ht=Qt[1],X=(0,e.useRef)(null),Y=(0,e.useRef)(null),pt=(0,e.useRef)([]);(0,e.useEffect)(function(){for(var S=[],h=1;;){var F="".concat(U,".tip.").concat(h),I=N.formatMessage({id:F,defaultMessage:"END"});if(I==="END"||I===F)break;S.push(I),h++}pt.current=S},[U,N]);var st=(0,e.useCallback)(function(){t.J7.stop(),t.J7.cancel(),Lt(!1),gt(!1),St(null),Ct(""),Ht([]),Ot(null),Y.current&&(clearInterval(Y.current),Y.current=null)},[]),kt=(0,e.useCallback)(function(){if(pt.current.length===0)return"";var S=Math.floor(Math.random()*pt.current.length);return pt.current[S]},[]),be=(0,e.useCallback)(function(){if(dt)t.J7.start(),gt(!1);else{var S;t.J7.pause(),(S=X.current)===null||S===void 0||S.releaseAll(),gt(!0)}},[dt]),Dt=(0,e.useCallback)(f()(d()().mark(function S(){var h,F,I,H,A,It,ee,ae,ne,re,it,oe,k;return d()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:Lt(!0),gt(!1),Bt(1),zt(1),t.J7.cancel(),t.J7.bpm.value=ot,h=t.Di(ut).toMidi(),F=t.Di(mt).toMidi(),I=F>=h?1:-1,H=Math.abs(F-h),Ne(H+1),A=0,It=tt/1e3,ee=at/1e3,ae=vt/1e3,ne=T/1e3,re=E/1e3,it=0;case 18:if(!(it<M)){W.next=29;break}oe=d()().mark(function ye(){var Tt,Mt,se,ie,le,xt,ce,Et;return d()().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:Tt=h+k*I,Mt=t.Di(Tt,"midi").toNote(),se=$.map(function(B){return t.Di(Tt+B,"midi").toNote()}),ie=it+1,le=k+1,xt=it===0&&k===0,t.J7.schedule(function(B){var J;t.hG.schedule(function(){Bt(ie),zt(le),Ht(se),Ct(Mt),Ot(-1),xt&&Yt(N.formatMessage({id:"".concat(U,".tip.0")}))},B),(J=X.current)===null||J===void 0||J.triggerAttackRelease(Mt,It,B)},A),A+=It,t.J7.schedule(function(B){t.hG.schedule(function(){xt||Yt(kt())},B)},A),ce=d()().mark(function B(J){var ue,Rt,lt;return d()().wrap(function(bt){for(;;)switch(bt.prev=bt.next){case 0:ue=Tt+$[J],Rt=t.Di(ue,"midi").toNote(),lt=ae,J===0?lt=ee:J===$.length-1&&(lt=ne),t.J7.schedule(function(me){var Pt;t.hG.schedule(function(){Ct(Rt),Ot(J)},me),(Pt=X.current)===null||Pt===void 0||Pt.triggerAttackRelease(Rt,lt,me)},A),A+=lt;case 6:case"end":return bt.stop()}},B)}),Et=0;case 11:if(!(Et<$.length)){q.next=16;break}return q.delegateYield(ce(Et),"t0",13);case 13:Et++,q.next=11;break;case 16:A+=re;case 17:case"end":return q.stop()}},ye)}),k=0;case 21:if(!(k<=H)){W.next=26;break}return W.delegateYield(oe(),"t0",23);case 23:k++,W.next=21;break;case 26:it++,W.next=18;break;case 29:t.J7.schedule(function(){t.hG.schedule(function(){st()},t.J7.seconds+.1)},A),t.J7.start();case 31:case"end":return W.stop()}},S)})),[ut,mt,tt,at,vt,T,E,M,ot,N,kt,st,$,U]),Pe=(0,g.u)("piano"),ht=Pe.status,qt=(0,e.useRef)(ht);qt.current=ht;var te=(0,e.useCallback)(f()(d()().mark(function S(){var h;return d()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,t.Do.resume();case 2:return I.next=4,t.BL();case 4:h=function(){if(K>0){var A=Math.ceil(K/1e3);St(A),Y.current=setInterval(function(){A--,A>0?St(A):(St(null),Y.current&&(clearInterval(Y.current),Y.current=null),Dt())},1e3)}else Dt()},qt.current==="loaded"?(0,p.pr)("piano").then(function(H){X.current=H,_t(!1),h()}):(console.log("Instrument not loaded, falling back to synth"),X.current=new t.v2(t.WV).toDestination(),_t(!0),h());case 6:case"end":return I.stop()}},S)})),[K,Dt]);return(0,e.useEffect)(function(){j&&At&&ht==="loaded"&&(0,p.pr)("piano").then(function(S){X.current=S,_t(!1),y.ZP.success(N.formatMessage({id:"vocal.ma-exercise.piano-loaded"}))})},[j,At,ht,N]),(0,e.useEffect)(function(){if(!j){st();return}return te(),function(){return st()}},[j,te,st]),(0,a.jsx)(b.Z,{open:j,onCancel:Q,footer:null,destroyOnHidden:!0,width:"90%",style:{maxWidth:800},centered:!0,maskClosable:!1,title:jt?"".concat(he,"/").concat(M," - ").concat(_e,"/").concat(Ee):N.formatMessage({id:"".concat(U,".title")}),children:(0,a.jsxs)("div",{className:"vocal-player-container",children:[Ut!==null&&(0,a.jsxs)("div",{className:"countdown-overlay",children:[(0,a.jsx)(C.Z.Title,{className:"countdown-number",style:{color:Nt.colorPrimary},children:Ut}),(0,a.jsx)(C.Z.Text,{strong:!0,className:"countdown-text",children:"\u51C6\u5907\u5F00\u59CB | Ready"})]}),At&&(0,a.jsx)(z.Z,{type:"warning",showIcon:!0,title:N.formatMessage({id:"vocal.ma-exercise.midi-warning"}),style:{marginBottom:16},closable:!0}),(0,a.jsxs)(v.Z,{orientation:"vertical",size:32,className:"player-content",children:[(0,a.jsx)("div",{className:"display-area",children:(0,a.jsx)(r.Z,{className:"display-card",variant:"borderless",children:(0,a.jsx)(C.Z.Text,{strong:!0,className:"display-tip",style:{color:Nt.colorTextSecondary},children:jt?xe:N.formatMessage({id:"".concat(U,".tip.0")})})})}),(0,a.jsx)("div",{className:"visualization-area",children:Xt.length>0?Xt.map(function(S,h){var F=Ce===h;return(0,a.jsx)("div",{className:"note-circle ".concat(F?"note-circle-active":""),children:S},h)}):(0,a.jsx)(C.Z.Title,{level:4,type:"secondary",className:"visualization-ready",children:"READY TO TRAIN"})}),(0,a.jsxs)(v.Z,{orientation:"vertical",size:16,className:"controls-area",children:[(0,a.jsx)("div",{className:"current-note-name",style:{color:Nt.colorText},children:Ie||"-"}),(0,a.jsx)(o.ZP,{type:"primary",size:"large",shape:"round",icon:dt?(0,a.jsx)(_.Z,{}):(0,a.jsx)(w.Z,{}),onClick:be,style:{width:160},children:N.formatMessage({id:dt?"vocal.ma-exercise.resume":"vocal.ma-exercise.pause"})})]})]})]})})},Z=m},15813:function(ct,P,n){n.d(P,{Z:function(){return z}});var i=n(67849),d=n(40624),R=n(24486),f=n(97375),s=n(31770),c=n(84611),g=n(82238),p=n(45803),_=n(52402),w=n(75271),O=n(55248),l=n(52676),y=function(){for(var r=[],o=O.Di("A2").toMidi(),e=O.Di("C6").toMidi(),t=o;t<=e;t++)r.push(O.Di(t,"midi").toNote());return r},b=y().map(function(v){return{label:v,value:v}}),C=function(r){var o=r.presets,e=r.localizationPrefix,t=(0,g.useIntl)(),a=d.A.useFormInstance(),m=(0,i.L3)(t),Z=function(u){o[u]&&(a==null||a.setFieldsValue(o[u]))};return(0,l.jsxs)("div",{className:"vocal-settings-container",children:[(0,l.jsxs)(p.Z,{title:t.formatMessage({id:"vocal.ma-exercise.settings.group.range"}),size:"small",className:"settings-card",children:[(0,l.jsx)(R.Z.Group,{name:"preset",radioType:"button",label:t.formatMessage({id:"vocal.ma-exercise.settings.preset"}),options:[{label:t.formatMessage({id:"".concat(e,".settings.preset.male")}),value:"male"},{label:t.formatMessage({id:"".concat(e,".settings.preset.female")}),value:"female"},{label:t.formatMessage({id:"vocal.ma-exercise.settings.preset.custom"}),value:"custom"}],fieldProps:{buttonStyle:"solid",size:"middle",onChange:function(u){return Z(u.target.value)}}}),(0,l.jsx)(f.Z,{name:["preset"],children:function(u){var j=u.preset,Q=j==="custom";return(0,l.jsxs)(_.Z,{direction:"horizontal",size:window.innerWidth<640?0:16,wrap:!0,style:{width:"100%",marginTop:16},children:[(0,l.jsx)(s.Z,{name:"startNote",label:t.formatMessage({id:"vocal.ma-exercise.settings.start-note"}),options:b,width:"sm",disabled:!Q,rules:[{required:!0}]}),(0,l.jsx)(s.Z,{name:"endNote",label:t.formatMessage({id:"vocal.ma-exercise.settings.end-note"}),options:b,width:"sm",disabled:!Q,rules:[{required:!0}]})]})}}),(0,l.jsx)(c.Z,{name:"loopCount",label:t.formatMessage({id:"vocal.ma-exercise.settings.loop-count"}),min:1,max:10,width:"md"})]}),(0,l.jsx)(p.Z,{title:t.formatMessage({id:"vocal.ma-exercise.settings.group.root"}),size:"small",className:"settings-card",children:(0,l.jsxs)(_.Z,{direction:"horizontal",size:16,wrap:!0,className:"settings-row",children:[(0,l.jsx)(c.Z,{name:"countdown",label:t.formatMessage({id:"vocal.ma-exercise.settings.countdown"}),width:"md",min:i.Qx,max:i.Zf,step:i.LB,fieldProps:{tooltip:{formatter:m}}}),(0,l.jsx)(c.Z,{name:"rootNoteWait",label:t.formatMessage({id:"vocal.ma-exercise.settings.root-wait"}),width:"md",min:i.Qx,max:i.Zf,step:i.LB,fieldProps:{tooltip:{formatter:m}}})]})}),(0,l.jsx)(p.Z,{title:t.formatMessage({id:"vocal.ma-exercise.settings.group.melody"}),size:"small",className:"settings-card",children:(0,l.jsxs)(_.Z,{direction:"horizontal",size:16,wrap:!0,className:"settings-row",children:[(0,l.jsx)(c.Z,{name:"firstNoteDuration",label:t.formatMessage({id:"vocal.ma-exercise.settings.first-note-duration"}),width:"md",min:i.Qx,max:i.Zf,step:i.LB,fieldProps:{tooltip:{formatter:m}}}),(0,l.jsx)(c.Z,{name:"intervalDuration",label:t.formatMessage({id:"vocal.ma-exercise.settings.interval-duration"}),width:"md",min:i.Qx,max:i.Zf,step:i.LB,fieldProps:{tooltip:{formatter:m}}}),(0,l.jsx)(c.Z,{name:"lastNoteDuration",label:t.formatMessage({id:"vocal.ma-exercise.settings.last-note-duration"}),width:"md",min:i.Qx,max:i.Zf,step:i.LB,fieldProps:{tooltip:{formatter:m}}}),(0,l.jsx)(c.Z,{name:"postMelodyWait",label:t.formatMessage({id:"vocal.ma-exercise.settings.post-melody-wait"}),width:"md",min:i.Qx,max:i.Zf,step:i.LB,fieldProps:{tooltip:{formatter:m}}})]})})]})},z=C},6946:function(ct,P,n){n.d(P,{GR:function(){return w},Jm:function(){return O},QM:function(){return l},Tp:function(){return c},_Y:function(){return _},bA:function(){return b},fy:function(){return p},lv:function(){return z},oB:function(){return C},pd:function(){return g},qt:function(){return y}});var i=n(48305),d=n.n(i),R=n(31759),f=n.n(R),s=n(67849),c=function(r,o){var e=localStorage.getItem("".concat(s.f1).concat(r));if(!e&&r==="tones:training"){var t=localStorage.getItem("music-teaching-assistant-settings");if(t)return localStorage.setItem("".concat(s.f1).concat(r),t),JSON.parse(t)}if(!e)return o;try{var a=JSON.parse(e);return a&&f()(a)==="object"&&"name"in a&&"value"in a?a.value:a}catch(m){return console.error("Failed to parse settings for ".concat(r),m),o}},g=function(r,o,e){var t=localStorage.getItem("".concat(s.f1).concat(r)),a=e;if(!a&&t)try{var m=JSON.parse(t);m!=null&&m.name&&(a=m.name)}catch(V){}var Z={name:a||r,value:o,updatedAt:Date.now()};localStorage.setItem("".concat(s.f1).concat(r),JSON.stringify(Z))},p=function(r,o){var e=localStorage.getItem("".concat(s.CV).concat(r));if(!e)return o;try{var t=JSON.parse(e);return t&&f()(t)==="object"&&"name"in t&&"value"in t?t.value:t}catch(a){return console.error("Failed to parse stats for ".concat(r),a),o}},_=function(r,o,e){var t=localStorage.getItem("".concat(s.CV).concat(r)),a=e;if(!a&&t)try{var m=JSON.parse(t);m!=null&&m.name&&(a=m.name)}catch(V){}var Z={name:a||r,value:o,updatedAt:Date.now()};localStorage.setItem("".concat(s.CV).concat(r),JSON.stringify(Z))},w=function(){for(var r={},o=0;o<localStorage.length;o++){var e=localStorage.key(o);if(e!=null&&e.startsWith(s.f1)){var t=localStorage.getItem(e);if(t)try{r[e.replace(s.f1,"")]=JSON.parse(t)}catch(a){console.error("Failed to parse all settings for key ".concat(e),a)}}}return r},O=function(){for(var r={},o=0;o<localStorage.length;o++){var e=localStorage.key(o);if(e!=null&&e.startsWith(s.CV)){var t=localStorage.getItem(e);if(t)try{r[e.replace(s.CV,"")]=JSON.parse(t)}catch(a){console.error("Failed to parse all stats for key ".concat(e),a)}}}return r},l=function(r){if(r&&f()(r)==="object"){if(r.settings||r.stats){r.settings&&Object.entries(r.settings).forEach(function(o){var e=d()(o,2),t=e[0],a=e[1];a&&f()(a)==="object"&&"name"in a&&"value"in a?localStorage.setItem("".concat(s.f1).concat(t),JSON.stringify(a)):g(t,a,t)}),r.stats&&Object.entries(r.stats).forEach(function(o){var e=d()(o,2),t=e[0],a=e[1];a&&f()(a)==="object"&&"name"in a&&"value"in a?localStorage.setItem("".concat(s.CV).concat(t),JSON.stringify(a)):_(t,a,t)});return}Object.entries(r).forEach(function(o){var e=d()(o,2),t=e[0],a=e[1];a&&f()(a)==="object"&&"name"in a&&"value"in a?localStorage.setItem("".concat(s.f1).concat(t),JSON.stringify(a)):g(t,a,t)})}},y=function(){for(var r=[],o=0;o<localStorage.length;o++){var e=localStorage.key(o);e!=null&&e.startsWith(s.f1)&&r.push(e)}r.forEach(function(t){return localStorage.removeItem(t)})},b=function(r){localStorage.removeItem("".concat(s.f1).concat(r))},C=function(){for(var r=[],o=0;o<localStorage.length;o++){var e=localStorage.key(o);e!=null&&e.startsWith(s.CV)&&r.push(e)}r.forEach(function(t){return localStorage.removeItem(t)})},z=function(r){localStorage.removeItem("".concat(s.CV).concat(r))}}}]);
