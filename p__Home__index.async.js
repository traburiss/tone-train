"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[371],{24486:function(Mg,Y,o){o.r(Y),o.d(Y,{default:function(){return zg}});var tg=o(26068),h=o.n(tg),ag=o(48305),S=o.n(ag),n=o(89504),L=o(40334),w=o(76582),M=o(99063),sg=o(4827),H=o(81485),rg=o(39493),J=o(29219),x=o(75271),g=o(52676),ug=function(){return(0,g.jsxs)(J.Z,{title:"\u57FA\u7840\u914D\u7F6E",className:"mb-3 sm:mb-6",children:[(0,g.jsxs)(L.A.Group,{size:8,children:[(0,g.jsx)(w.Z.Group,{name:"instrumentName",label:"\u97F3\u8272",radioType:"button",options:n.qL}),(0,g.jsx)(w.Z.Group,{name:"loopCountType",label:"\u5FAA\u73AF\u6B21\u6570",radioType:"button",options:n.qx}),(0,g.jsx)(M.Z,{name:["loopCountType"],children:function(i){var C=i.loopCountType;return C==="custom"&&(0,g.jsx)(sg.Z,{name:"loopCountCustom",label:"\u81EA\u5B9A\u4E49\u6B21\u6570",width:"xs",min:1,max:1e3,fieldProps:{precision:0}})}})]}),(0,g.jsxs)(L.A.Group,{size:8,children:[(0,g.jsx)(H.Z,{name:"ttsEnable",label:"\u8BED\u97F3\u62A5\u53F7"}),(0,g.jsx)(H.Z,{name:"random",label:"\u968F\u673A\u64AD\u653E"}),(0,g.jsx)(H.Z,{name:"referenceNoteEnabled",label:"\u64AD\u653E\u5BF9\u6BD4\u57FA\u51C6\u97F3"}),(0,g.jsx)(M.Z,{name:["referenceNoteEnabled"],children:function(i){var C=i.referenceNoteEnabled;return C&&(0,g.jsx)(rg.Z,{name:"referenceNote",label:"\u57FA\u51C6\u97F3",width:"xs",options:n.cS})}})]})]})},lg=ug,V=o(24871),ig=o(31005),cg=function(){return(0,g.jsx)(J.Z,{title:"\u64AD\u653E\u53C2\u6570",className:"mb-3 sm:mb-6",children:(0,g.jsxs)(L.A.Group,{children:[(0,g.jsx)(V.Z,{name:"toneDuration",label:"\u97F3\u9636\u65F6\u957F",width:"md",min:n.Qx,max:n.Zf,step:n.LB,fieldProps:{tooltip:{formatter:n.QZ}}}),(0,g.jsx)(V.Z,{name:"toneWait",label:"\u97F3\u9636\u64AD\u540E\u7B49\u5F85",width:"md",min:n.Qx,max:n.Zf,step:n.LB,fieldProps:{tooltip:{formatter:n.QZ}}}),(0,g.jsx)(V.Z,{name:"ttsWait",label:"\u62A5\u97F3\u9636\u540E\u7B49\u5F85",width:"md",min:n.Qx,max:n.Zf,step:n.LB,fieldProps:{tooltip:{formatter:n.QZ}}}),(0,g.jsx)(M.Z,{name:["ttsEnable"],children:function(i){var C=i.ttsEnable;return C&&(0,g.jsx)(V.Z,{name:"ttsRate",label:(0,g.jsx)(ig.Z,{title:"\u500D\u6570\u8D8A\u5927\u8D8A\u6162",children:"\u62A5\u97F3\u9636\u8BED\u901F"}),width:"md",min:.5,max:4,step:.1,fieldProps:{tooltip:{formatter:function(G){return"".concat(G,"x \u65F6\u957F")}}}})}})]})})},Cg=cg,fg=o(15558),Ag=o.n(fg),mg=o(93817),Fg=o(1059),Dg=o(72783),Gg=o(36065),U=o(79662),z=o(95216),dg=function(){var e=Gg.Z.useFormInstance(),i=(0,x.useState)([]),C=S()(i,2),D=C[0],G=C[1],y=function(l){G(function(u){return u.includes(l)?u.filter(function(f){return f!==l}):[].concat(Ag()(u),[l])})},d=function(l,u,f){var a=f.map(function(c){return"".concat(c).concat(l)});e.setFieldValue(["toneListGroup",l],u?a:[])},T=function(l,u){var f=n.aj.map(function(a){return"".concat(a).concat(l)});e.setFieldValue(["toneListGroup",l],u?f:[])},P=function(l,u){var f=u==="8Tone"?n.aj:n.An,a={};n.Dz.forEach(function(c){a[c]=l?f.map(function(t){return"".concat(t).concat(c)}):[]}),e.setFieldValue("toneListGroup",a)},R=function(l){var u={};n.Dz.forEach(function(f){u[f]=l?n.aj.map(function(a){return"".concat(a).concat(f)}):[]}),e.setFieldValue("toneListGroup",u)};return(0,g.jsx)(M.Z,{name:["toneType","toneListGroup"],children:function(l){var u=l.toneType,f=l.toneListGroup;return(0,g.jsx)(J.Z,{title:"\u97F3\u9636\u8BBE\u7F6E",className:"scale-card mb-6",extra:(0,g.jsxs)(U.Z,{size:12,wrap:!0,children:[(0,g.jsxs)(U.Z,{size:4,children:[(0,g.jsx)(z.ZP,{size:"small",onClick:function(){return P(!0,u)},children:"\u5168\u9009"}),u!=="8Tone"&&(0,g.jsx)(z.ZP,{size:"small",onClick:function(){return R(!0)},children:"\u5168\u97F3"})]}),(0,g.jsx)("div",{className:"w-[1px] h-[14px] bg-[#e8e8e8]"}),(0,g.jsx)(w.Z.Group,{name:"toneType",noStyle:!0,radioType:"button",options:n.N7})]}),children:(0,g.jsx)("div",{className:"flex flex-col gap-2",children:n.Dz.map(function(a){var c=u==="8Tone"?n.aj:n.An,t=(f==null?void 0:f[a])||[],r=t.length===c.length,m=t.length===n.aj.length&&n.aj.every(function(v){return t.includes("".concat(v).concat(a))});return(0,g.jsxs)("div",{className:"octave-row p-2 sm:p-2.5 border border-[#f0f0f0] rounded-lg bg-[#fafafa] flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-3",children:[(0,g.jsxs)("div",{className:"flex items-center gap-2 shrink-0 w-full sm:w-auto",children:[(0,g.jsxs)("span",{className:"font-bold text-[14px] sm:text-[15px] text-[#1a1a1a] mr-1",children:["Oct ",a]}),(0,g.jsxs)(U.Z,{size:4,children:[(0,g.jsx)(z.ZP,{size:"small",type:r?"primary":"default",onClick:function(){return d(a,!r,c)},className:"text-[12px]",children:"\u5168\u9009"}),u!=="8Tone"&&(0,g.jsx)(z.ZP,{size:"small",type:m?"primary":"default",onClick:function(){return T(a,!m)},className:"text-[12px]",children:"\u5168\u97F3"})]}),(0,g.jsxs)("span",{className:"text-[11px] sm:text-[12px] color-[#888] ml-1 min-w-[20px]",children:["(",t.length,")"]}),(0,g.jsx)(z.ZP,{type:"text",size:"small",className:"sm:hidden ml-auto flex items-center gap-1 text-[#1890ff]",onClick:function(){return y(a)},children:D.includes(a)?(0,g.jsxs)(g.Fragment,{children:["\u6536\u8D77 ",(0,g.jsx)(Fg.Z,{className:"text-[10px]"})]}):(0,g.jsxs)(g.Fragment,{children:["\u5C55\u5F00 ",(0,g.jsx)(Dg.Z,{className:"text-[10px]"})]})})]}),(0,g.jsx)("div",{className:"hidden sm:block w-[1px] h-6 bg-[#e8e8e8]"}),(0,g.jsx)("div",{className:"".concat(D.includes(a)?"flex":"hidden sm:flex"," flex-wrap gap-1.5 flex-1 w-full"),children:(0,g.jsx)(mg.Z.Group,{name:["toneListGroup",a],className:"touch-button-group",options:c.map(function(v){return{label:v,value:"".concat(v).concat(a)}})})})]},a)})})})}})},vg=dg,xg=o(90228),N=o.n(xg),Eg=o(87999),K=o.n(Eg),I=o(55248),X={},hg={"bass-electric":{"A#1":"As1.ogg","A#2":"As2.ogg","A#3":"As3.ogg","A#4":"As4.ogg","C#1":"Cs1.ogg","C#2":"Cs2.ogg","C#3":"Cs3.ogg","C#4":"Cs4.ogg",E1:"E1.ogg",E2:"E2.ogg",E3:"E3.ogg",E4:"E4.ogg",G1:"G1.ogg",G2:"G2.ogg",G3:"G3.ogg",G4:"G4.ogg"},bassoon:{A4:"A4.ogg",C3:"C3.ogg",C4:"C4.ogg",C5:"C5.ogg",E4:"E4.ogg",G2:"G2.ogg",G3:"G3.ogg",G4:"G4.ogg",A2:"A2.ogg",A3:"A3.ogg"},cello:{E3:"E3.ogg",E4:"E4.ogg",F2:"F2.ogg",F3:"F3.ogg",F4:"F4.ogg","F#3":"Fs3.ogg","F#4":"Fs4.ogg",G2:"G2.ogg",G3:"G3.ogg",G4:"G4.ogg","G#2":"Gs2.ogg","G#3":"Gs3.ogg","G#4":"Gs4.ogg",A2:"A2.ogg",A3:"A3.ogg",A4:"A4.ogg","A#2":"As2.ogg","A#3":"As3.ogg",B2:"B2.ogg",B3:"B3.ogg",B4:"B4.ogg",C2:"C2.ogg",C3:"C3.ogg",C4:"C4.ogg",C5:"C5.ogg","C#3":"Cs3.ogg","C#4":"Cs4.ogg",D2:"D2.ogg",D3:"D3.ogg",D4:"D4.ogg","D#2":"Ds2.ogg","D#3":"Ds3.ogg","D#4":"Ds4.ogg",E2:"E2.ogg"},clarinet:{D4:"D4.ogg",D5:"D5.ogg",D6:"D6.ogg",F3:"F3.ogg",F4:"F4.ogg",F5:"F5.ogg","F#6":"Fs6.ogg","A#3":"As3.ogg","A#4":"As4.ogg","A#5":"As5.ogg",D3:"D3.ogg"},contrabass:{C2:"C2.ogg","C#3":"Cs3.ogg",D2:"D2.ogg",E2:"E2.ogg",E3:"E3.ogg","F#1":"Fs1.ogg","F#2":"Fs2.ogg",G1:"G1.ogg","G#2":"Gs2.ogg","G#3":"Gs3.ogg",A2:"A2.ogg","A#1":"As1.ogg",B3:"B3.ogg"},flute:{A6:"A6.ogg",C4:"C4.ogg",C5:"C5.ogg",C6:"C6.ogg",C7:"C7.ogg",E4:"E4.ogg",E5:"E5.ogg",E6:"E6.ogg",A4:"A4.ogg",A5:"A5.ogg"},"french-horn":{D3:"D3.ogg",D5:"D5.ogg","D#2":"Ds2.ogg",F3:"F3.ogg",F5:"F5.ogg",G2:"G2.ogg",A1:"A1.ogg",A3:"A3.ogg",C2:"C2.ogg",C4:"C4.ogg"},"guitar-acoustic":{F4:"F4.ogg","F#2":"Fs2.ogg","F#3":"Fs3.ogg","F#4":"Fs4.ogg",G2:"G2.ogg",G3:"G3.ogg",G4:"G4.ogg","G#2":"Gs2.ogg","G#3":"Gs3.ogg","G#4":"Gs4.ogg",A2:"A2.ogg",A3:"A3.ogg",A4:"A4.ogg","A#2":"As2.ogg","A#3":"As3.ogg","A#4":"As4.ogg",B2:"B2.ogg",B3:"B3.ogg",B4:"B4.ogg",C3:"C3.ogg",C4:"C4.ogg",C5:"C5.ogg","C#3":"Cs3.ogg","C#4":"Cs4.ogg","C#5":"Cs5.ogg",D2:"D2.ogg",D3:"D3.ogg",D4:"D4.ogg",D5:"D5.ogg","D#2":"Ds2.ogg","D#3":"Ds3.ogg","D#4":"Ds3.ogg",E2:"E2.ogg",E3:"E3.ogg",E4:"E4.ogg",F2:"F2.ogg",F3:"F3.ogg"},"guitar-electric":{"D#3":"Ds3.ogg","D#4":"Ds4.ogg","D#5":"Ds5.ogg",E2:"E2.ogg","F#2":"Fs2.ogg","F#3":"Fs3.ogg","F#4":"Fs4.ogg","F#5":"Fs5.ogg",A2:"A2.ogg",A3:"A3.ogg",A4:"A4.ogg",A5:"A5.ogg",C3:"C3.ogg",C4:"C4.ogg",C5:"C5.ogg",C6:"C6.ogg","C#2":"Cs2.ogg"},"guitar-nylon":{"F#2":"Fs2.ogg","F#3":"Fs3.ogg","F#4":"Fs4.ogg","F#5":"Fs5.ogg",G3:"G3.ogg",G5:"G3.ogg","G#2":"Gs2.ogg","G#4":"Gs4.ogg","G#5":"Gs5.ogg",A2:"A2.ogg",A3:"A3.ogg",A4:"A4.ogg",A5:"A5.ogg","A#5":"As5.ogg",B1:"B1.ogg",B2:"B2.ogg",B3:"B3.ogg",B4:"B4.ogg","C#3":"Cs3.ogg","C#4":"Cs4.ogg","C#5":"Cs5.ogg",D2:"D2.ogg",D3:"D3.ogg",D5:"D5.ogg","D#4":"Ds4.ogg",E2:"E2.ogg",E3:"E3.ogg",E4:"E4.ogg",E5:"E5.ogg"},harmonium:{C2:"C2.ogg",C3:"C3.ogg",C4:"C4.ogg",C5:"C5.ogg","C#2":"Cs2.ogg","C#3":"Cs3.ogg","C#4":"Cs4.ogg","C#5":"Cs5.ogg",D2:"D2.ogg",D3:"D3.ogg",D4:"D4.ogg",D5:"D5.ogg","D#2":"Ds2.ogg","D#3":"Ds3.ogg","D#4":"Ds4.ogg",E2:"E2.ogg",E3:"E3.ogg",E4:"E4.ogg",F2:"F2.ogg",F3:"F3.ogg",F4:"F4.ogg","F#2":"Fs2.ogg","F#3":"Fs3.ogg",G2:"G2.ogg",G3:"G3.ogg",G4:"G4.ogg","G#2":"Gs2.ogg","G#3":"Gs3.ogg","G#4":"Gs4.ogg",A2:"A2.ogg",A3:"A3.ogg",A4:"A4.ogg","A#2":"As2.ogg","A#3":"As3.ogg","A#4":"As4.ogg"},harp:{C5:"C5.ogg",D2:"D2.ogg",D4:"D4.ogg",D6:"D6.ogg",D7:"D7.ogg",E1:"E1.ogg",E3:"E3.ogg",E5:"E5.ogg",F2:"F2.ogg",F4:"F4.ogg",F6:"F6.ogg",F7:"F7.ogg",G1:"G1.ogg",G3:"G3.ogg",G5:"G5.ogg",A2:"A2.ogg",A4:"A4.ogg",A6:"A6.ogg",B1:"B1.ogg",B3:"B3.ogg",B5:"B5.ogg",B6:"B6.ogg",C3:"C3.ogg"},organ:{C3:"C3.ogg",C4:"C4.ogg",C5:"C5.ogg",C6:"C6.ogg","D#1":"Ds1.ogg","D#2":"Ds2.ogg","D#3":"Ds3.ogg","D#4":"Ds4.ogg","D#5":"Ds5.ogg","F#1":"Fs1.ogg","F#2":"Fs2.ogg","F#3":"Fs3.ogg","F#4":"Fs4.ogg","F#5":"Fs5.ogg",A1:"A1.ogg",A2:"A2.ogg",A3:"A3.ogg",A4:"A4.ogg",A5:"A5.ogg",C1:"C1.ogg",C2:"C2.ogg"},piano:{A7:"A7.ogg",A1:"A1.ogg",A2:"A2.ogg",A3:"A3.ogg",A4:"A4.ogg",A5:"A5.ogg",A6:"A6.ogg","A#7":"As7.ogg","A#1":"As1.ogg","A#2":"As2.ogg","A#3":"As3.ogg","A#4":"As4.ogg","A#5":"As5.ogg","A#6":"As6.ogg",B7:"B7.ogg",B1:"B1.ogg",B2:"B2.ogg",B3:"B3.ogg",B4:"B4.ogg",B5:"B5.ogg",B6:"B6.ogg",C1:"C1.ogg",C2:"C2.ogg",C3:"C3.ogg",C4:"C4.ogg",C5:"C5.ogg",C6:"C6.ogg",C7:"C7.ogg","C#7":"Cs7.ogg","C#1":"Cs1.ogg","C#2":"Cs2.ogg","C#3":"Cs3.ogg","C#4":"Cs4.ogg","C#5":"Cs5.ogg","C#6":"Cs6.ogg",D7:"D7.ogg",D1:"D1.ogg",D2:"D2.ogg",D3:"D3.ogg",D4:"D4.ogg",D5:"D5.ogg",D6:"D6.ogg","D#7":"Ds7.ogg","D#1":"Ds1.ogg","D#2":"Ds2.ogg","D#3":"Ds3.ogg","D#4":"Ds4.ogg","D#5":"Ds5.ogg","D#6":"Ds6.ogg",E7:"E7.ogg",E1:"E1.ogg",E2:"E2.ogg",E3:"E3.ogg",E4:"E4.ogg",E5:"E5.ogg",E6:"E6.ogg",F7:"F7.ogg",F1:"F1.ogg",F2:"F2.ogg",F3:"F3.ogg",F4:"F4.ogg",F5:"F5.ogg",F6:"F6.ogg","F#7":"Fs7.ogg","F#1":"Fs1.ogg","F#2":"Fs2.ogg","F#3":"Fs3.ogg","F#4":"Fs4.ogg","F#5":"Fs5.ogg","F#6":"Fs6.ogg",G7:"G7.ogg",G1:"G1.ogg",G2:"G2.ogg",G3:"G3.ogg",G4:"G4.ogg",G5:"G5.ogg",G6:"G6.ogg","G#7":"Gs7.ogg","G#1":"Gs1.ogg","G#2":"Gs2.ogg","G#3":"Gs3.ogg","G#4":"Gs4.ogg","G#5":"Gs5.ogg","G#6":"Gs6.ogg"},saxophone:{"D#5":"Ds5.ogg",E3:"E3.ogg",E4:"E4.ogg",E5:"E5.ogg",F3:"F3.ogg",F4:"F4.ogg",F5:"F5.ogg","F#3":"Fs3.ogg","F#4":"Fs4.ogg","F#5":"Fs5.ogg",G3:"G3.ogg",G4:"G4.ogg",G5:"G5.ogg","G#3":"Gs3.ogg","G#4":"Gs4.ogg","G#5":"Gs5.ogg",A4:"A4.ogg",A5:"A5.ogg","A#3":"As3.ogg","A#4":"As4.ogg",B3:"B3.ogg",B4:"B4.ogg",C4:"C4.ogg",C5:"C5.ogg","C#3":"Cs3.ogg","C#4":"Cs4.ogg","C#5":"Cs5.ogg",D3:"D3.ogg",D4:"D4.ogg",D5:"D5.ogg","D#3":"Ds3.ogg","D#4":"Ds4.ogg"},trombone:{"A#3":"As3.ogg",C3:"C3.ogg",C4:"C4.ogg","C#2":"Cs2.ogg","C#4":"Cs4.ogg",D3:"D3.ogg",D4:"D4.ogg","D#2":"Ds2.ogg","D#3":"Ds3.ogg","D#4":"Ds4.ogg",F2:"F2.ogg",F3:"F3.ogg",F4:"F4.ogg","G#2":"Gs2.ogg","G#3":"Gs3.ogg","A#1":"As1.ogg","A#2":"As2.ogg"},trumpet:{C6:"C6.ogg",D5:"D5.ogg","D#4":"Ds4.ogg",F3:"F3.ogg",F4:"F4.ogg",F5:"F5.ogg",G4:"G4.ogg",A3:"A3.ogg",A5:"A5.ogg","A#4":"As4.ogg",C4:"C4.ogg"},tuba:{"A#2":"As2.ogg","A#3":"As3.ogg",D3:"D3.ogg",D4:"D4.ogg","D#2":"Ds2.ogg",F1:"F1.ogg",F2:"F2.ogg",F3:"F3.ogg","A#1":"As1.ogg"},violin:{A3:"A3.ogg",A4:"A4.ogg",A5:"A5.ogg",A6:"A6.ogg",C4:"C4.ogg",C5:"C5.ogg",C6:"C6.ogg",C7:"C7.ogg",E4:"E4.ogg",E5:"E5.ogg",E6:"E6.ogg",G4:"G4.ogg",G5:"G5.ogg",G6:"G6.ogg"},xylophone:{C8:"C8.ogg",G4:"G4.ogg",G5:"G5.ogg",G6:"G6.ogg",G7:"G7.ogg",C5:"C5.ogg",C6:"C6.ogg",C7:"C7.ogg"}},pg=function(){var Z=K()(N()().mark(function e(i){var C,D,G;return N()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(C=hg[i],C!=null){d.next=3;break}throw new Error("no such instruments: ".concat(i));case 3:if(D=X[i],D==null){d.next=6;break}return d.abrupt("return",D);case 6:return G=new I.Z4({urls:C,release:1,baseUrl:"samples/".concat(i,"/")}).toDestination(),d.next=9,I.CL();case 9:return X[i]=G,d.abrupt("return",G);case 11:case"end":return d.stop()}},e)}));return function(i){return Z.apply(this,arguments)}}(),jg=o(53419),Bg=o(99430),q=o(66931),Sg=o(65257),bg=o(98649),yg={trainPlayInfo:"trainPlayInfo___N471F"},Tg=q.Z.confirm,b=null,Ng=function(e){var i=(0,x.useState)(!0),C=S()(i,2),D=C[0],G=C[1],y=(0,x.useState)(!1),d=S()(y,2),T=d[0],P=d[1],R=(0,x.useState)("..."),E=S()(R,2),l=E[0],u=E[1],f=Sg.ZP.useNotification(),a=S()(f,2),c=a[0],t=a[1],r=x.useRef(0),m=x.useRef(0),v=function(p){var j=new SpeechSynthesisUtterance(p),B=e.ttsRate||1;j.rate=1/B,window.speechSynthesis.speak(j)},gg=function(){var A=K()(N()().mark(function p(j,B){return N()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return console.info("playTone",j,B),b!==null&&b.triggerAttackRelease(j,B/1e3),O.abrupt("return",new Promise(function(k){setTimeout(k,B)}));case 3:case"end":return O.stop()}},p)}));return function(j,B){return A.apply(this,arguments)}}(),og=x.useRef(e);og.current=e;var eg=x.useMemo(function(){var A=(e.toneDuration||0)+(e.toneWait||0)+(e.ttsWait||0)+(e.referenceNoteEnabled?(e.toneDuration||0)+(e.toneWait||0):0);return Math.max(A,500)},[e.toneDuration,e.toneWait,e.ttsWait,e.referenceNoteEnabled]);(0,x.useEffect)(function(){if(D||!e.open){b!==null&&b.triggerRelease(I.zO());return}var A=!1,p=null,j=null,B=function(){var O=K()(N()().mark(function k(){var F,W,$,Q;return N()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!A){s.next=2;break}return s.abrupt("return");case 2:if(F=og.current,W=F.toneList.length,W!==0){s.next=6;break}return s.abrupt("return");case 6:if($=0,F.random?$=Math.floor(Math.random()*W):$=r.current,Q=F.toneList[$],u(Q),F.random){s.next=20;break}if(r.current++,!(r.current>=W)){s.next=18;break}if(r.current=0,m.current++,!(Number(F.loopCount)>0&&m.current>=Number(F.loopCount))){s.next=18;break}return G(!0),s.abrupt("return");case 18:s.next=27;break;case 20:if(r.current++,!(r.current>=W)){s.next=27;break}if(r.current=0,m.current++,!(Number(F.loopCount)>0&&m.current>=Number(F.loopCount))){s.next=27;break}return G(!0),s.abrupt("return");case 27:if(!(F.referenceNoteEnabled&&F.referenceNote)){s.next=36;break}if(!A){s.next=30;break}return s.abrupt("return");case 30:return s.next=32,gg(F.referenceNote,F.toneDuration);case 32:if(!A){s.next=34;break}return s.abrupt("return");case 34:return s.next=36,new Promise(function(Wg){j=setTimeout(Wg,F.toneWait)});case 36:if(!A){s.next=38;break}return s.abrupt("return");case 38:return s.next=40,gg(Q,F.toneDuration);case 40:if(!A){s.next=42;break}return s.abrupt("return");case 42:F.ttsEnable&&(p=setTimeout(function(){A||v(Q)},F.toneWait||200));case 43:case"end":return s.stop()}},k)}));return function(){return O.apply(this,arguments)}}();B();var ng=setInterval(B,eg);return function(){A=!0,clearInterval(ng),p&&clearTimeout(p),j&&clearTimeout(j),b!==null&&b.triggerRelease(I.zO())}},[D,e.open,eg]),(0,x.useEffect)(function(){console.info("open 1 ",e),e.open&&(console.info("open 2 "),r.current=0,m.current=0,u("..."),P(!0),console.info("open 3 load instrumentName ".concat(e.instrumentName)),pg(e.instrumentName).then(function(A){console.info("load instrumentName ".concat(e.instrumentName," success")),b=A}).catch(function(A){console.info("load instrumentName ".concat(e.instrumentName," error"),A),c.error({message:"\u5F02\u5E38",description:"\u65E0\u6CD5\u52A0\u8F7D\u97F3\u8272\uFF0C\u53EA\u80FD\u64AD\u653EMIDI\u97F3"}),b=new I.WV().toDestination()}).finally(function(){P(!1),G(!1)}))},[e.open]);var Ig=function(){G(!D)},Rg=function(){G(!0),Tg({title:"\u786E\u8BA4\u505C\u6B62",icon:(0,g.jsx)(jg.Z,{}),content:"\u786E\u8BA4\u505C\u6B62\u8BAD\u7EC3\u5417\uFF1F",okText:"\u786E\u8BA4\u5173\u95ED",cancelText:"\u6211\u70B9\u9519\u4E86",onOk:function(){e.onCancel()},onCancel:function(){G(!1)}})};return(0,g.jsxs)(g.Fragment,{children:[t,(0,g.jsx)(q.Z,{open:e.open,destroyOnClose:!0,width:"80%",height:"80%",maskClosable:!1,okText:D?"\u6062\u590D\u8BAD\u7EC3":"\u6682\u505C\u8BAD\u7EC3",onOk:Ig,cancelText:"\u505C\u6B62\u8BAD\u7EC3",onCancel:Rg,loading:T,title:T?"\u52A0\u8F7D\u97F3\u8272\u4E2D":"\u8BAD\u7EC3",children:(0,g.jsx)(bg.ZP,{className:yg.trainPlayInfo,title:(0,g.jsx)("div",{className:"text-2xl sm:text-4xl",children:l}),subTitle:"\u5F53\u524D\u7684\u97F3\u662F",icon:(0,g.jsx)(Bg.Z,{})})})]})},Zg=Ng,Pg=o(82796),Og=o(90834),_="tone-train-settings",Lg=function(){var e=(0,x.useState)(n.sO),i=S()(e,2),C=i[0],D=i[1],G=(0,x.useState)(!1),y=S()(G,2),d=y[0],T=y[1],P=L.A.useForm(),R=S()(P,1),E=R[0],l=function(t){return Object.values(t||{}).flat().filter(Boolean)},u=function(t){var r={};return n.Dz.forEach(function(m){r[m]=t.filter(function(v){return v.endsWith(String(m))})}),r};(0,x.useEffect)(function(){var c=localStorage.getItem(_);if(c)try{var t=JSON.parse(c);t.toneList&&!t.toneListGroup&&(t.toneListGroup=u(t.toneList));var r=t.loopCountType||String(t.loopCount||0),m=t.loopCountCustom||t.loopCount||10;E.setFieldsValue(h()(h()({},t),{},{loopCountType:r,loopCountCustom:r==="custom"?m:10})),D(h()(h()(h()({},n.sO),t),{},{loopCount:r==="custom"?m:parseInt(r,10),toneList:l(t.toneListGroup)}))}catch(v){console.error("Failed to load settings",v)}},[E]);var f=function(t,r){localStorage.setItem(_,JSON.stringify(r))},a=function(t){var r=l(t.toneListGroup),m=t.loopCountType==="custom"?t.loopCountCustom:parseInt(t.loopCountType,10),v=h()(h()(h()({},n.sO),t),{},{toneList:r,loopCount:isNaN(m)?0:m});D(v),T(!0)};return(0,g.jsxs)(Pg._z,{ghost:!0,className:"px-1 sm:px-4",children:[(0,g.jsxs)(L.A,{form:E,size:"large",initialValues:h()(h()({},n.sO),{},{loopCountType:String(n.sO.loopCount),loopCountCustom:10,toneListGroup:u(n.sO.toneList)}),onValuesChange:f,onFinish:a,layout:"horizontal",submitter:{searchConfig:{resetText:"\u91CD\u7F6E",submitText:"\u5F00\u59CB\u8BAD\u7EC3"},render:function(t,r){return(0,g.jsx)(Og.S,{children:r})}},children:[(0,g.jsx)(vg,{}),(0,g.jsx)(lg,{}),(0,g.jsx)(Cg,{})]}),(0,g.jsx)(Zg,h()({open:d,onCancel:function(){return T(!1)}},C))]})},zg=Lg}}]);
